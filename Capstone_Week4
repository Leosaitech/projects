{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true
   },
   "source": [
    " # **Applied Data Science Capstone: Battle of Neighborhoods: Buenos Aires**"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "## 1) Problem Description\n",
    "\n",
    "People in argentina like good gastronimic quality. Going to restaurants and sharing a meal among friends and family, spending a whole afternoon chatting while enjoying a post-meal cofee is one the most Argentina traditions of all time. For this reason restaurant are a big deal.\n",
    "\n",
    "With this in mind, friend of mine who is a Chef and lives in Buenos Aires, Argentina, has won a cooking competition and received some price money to set up his Restaurant. However he is not sure where he can set it up. The goal of the project is to select an optimal location for his new restaurant.\n",
    "\n",
    "- How many venues in each neighborhood?\n",
    "\n",
    "- How many categories in neighborhood?\n",
    "\n",
    "- How many venues in each neighborhood?\n",
    "\n",
    "- What are the most popular categories in each neighborhood?\n",
    "\n",
    "- Also it is important to mention that he has a budget an unlimited budget, since the prize its called: \"Restaurant of your dreams Prize\" \n",
    "\n",
    "\n",
    "\n",
    "\n",
    "## 2) Data that will be used\n",
    "\n",
    "To find the answer to this questions we will be using public available data to answer question that can lead us for best possible location for the restaurant. \n",
    "\n",
    "**1. List of Neighborhoods of Buenos Aires** https://en.wikipedia.org/wiki/Neighbourhoods_of_Buenos_Aires\n",
    "\n",
    "\n",
    "**2. Lists of Food Venues in Buenos Aires**\n",
    "\n",
    "\n",
    "**3. Socio-Economic data of Buenos Aires**\n",
    "\n",
    "\n",
    "Below a data description is included\n",
    "\n",
    "*List of Neighborhoods of Buenos Aires:* \n",
    "- A list of all neighbohoods will allow us to understand the different areas of the city where the restaurant can be set\n",
    "\n",
    "*Food Venues*\n",
    "- It is important to understan what other types of restaurants are out there so as not to create a price war against incumbent venues\n",
    "\n",
    "*Socio-Economic Data*\n",
    "- This data will allow us to learn in what areas of the city has higher income and have an idea where would it be more suitable to put the restaurant"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Solving environment: done\n",
      "\n",
      "## Package Plan ##\n",
      "\n",
      "  environment location: /opt/conda/envs/Python36\n",
      "\n",
      "  added / updated specs: \n",
      "    - geopy\n",
      "\n",
      "\n",
      "The following packages will be downloaded:\n",
      "\n",
      "    package                    |            build\n",
      "    ---------------------------|-----------------\n",
      "    geographiclib-1.50         |             py_0          34 KB  conda-forge\n",
      "    certifi-2020.4.5.1         |   py36h9f0ad1d_0         151 KB  conda-forge\n",
      "    ca-certificates-2020.4.5.1 |       hecc5488_0         146 KB  conda-forge\n",
      "    geopy-1.21.0               |             py_0          58 KB  conda-forge\n",
      "    openssl-1.1.1g             |       h516909a_0         2.1 MB  conda-forge\n",
      "    python_abi-3.6             |          1_cp36m           4 KB  conda-forge\n",
      "    ------------------------------------------------------------\n",
      "                                           Total:         2.5 MB\n",
      "\n",
      "The following NEW packages will be INSTALLED:\n",
      "\n",
      "    geographiclib:   1.50-py_0         conda-forge\n",
      "    geopy:           1.21.0-py_0       conda-forge\n",
      "    python_abi:      3.6-1_cp36m       conda-forge\n",
      "\n",
      "The following packages will be UPDATED:\n",
      "\n",
      "    ca-certificates: 2020.1.1-0                    --> 2020.4.5.1-hecc5488_0     conda-forge\n",
      "    certifi:         2020.4.5.1-py36_0             --> 2020.4.5.1-py36h9f0ad1d_0 conda-forge\n",
      "    openssl:         1.1.1f-h7b6447c_0             --> 1.1.1g-h516909a_0         conda-forge\n",
      "\n",
      "\n",
      "Downloading and Extracting Packages\n",
      "geographiclib-1.50   | 34 KB     | ##################################### | 100% \n",
      "certifi-2020.4.5.1   | 151 KB    | ##################################### | 100% \n",
      "ca-certificates-2020 | 146 KB    | ##################################### | 100% \n",
      "geopy-1.21.0         | 58 KB     | ##################################### | 100% \n",
      "openssl-1.1.1g       | 2.1 MB    | ##################################### | 100% \n",
      "python_abi-3.6       | 4 KB      | ##################################### | 100% \n",
      "Preparing transaction: done\n",
      "Verifying transaction: done\n",
      "Executing transaction: done\n",
      "Solving environment: done\n",
      "\n",
      "## Package Plan ##\n",
      "\n",
      "  environment location: /opt/conda/envs/Python36\n",
      "\n",
      "  added / updated specs: \n",
      "    - folium=0.5.0\n",
      "\n",
      "\n",
      "The following packages will be downloaded:\n",
      "\n",
      "    package                    |            build\n",
      "    ---------------------------|-----------------\n",
      "    branca-0.4.0               |             py_0          26 KB  conda-forge\n",
      "    folium-0.5.0               |             py_0          45 KB  conda-forge\n",
      "    vincent-0.4.4              |             py_1          28 KB  conda-forge\n",
      "    altair-4.1.0               |             py_1         614 KB  conda-forge\n",
      "    ------------------------------------------------------------\n",
      "                                           Total:         713 KB\n",
      "\n",
      "The following NEW packages will be INSTALLED:\n",
      "\n",
      "    altair:  4.1.0-py_1 conda-forge\n",
      "    branca:  0.4.0-py_0 conda-forge\n",
      "    folium:  0.5.0-py_0 conda-forge\n",
      "    vincent: 0.4.4-py_1 conda-forge\n",
      "\n",
      "\n",
      "Downloading and Extracting Packages\n",
      "branca-0.4.0         | 26 KB     | ##################################### | 100% \n",
      "folium-0.5.0         | 45 KB     | ##################################### | 100% \n",
      "vincent-0.4.4        | 28 KB     | ##################################### | 100% \n",
      "altair-4.1.0         | 614 KB    | ##################################### | 100% \n",
      "Preparing transaction: done\n",
      "Verifying transaction: done\n",
      "Executing transaction: done\n",
      "Folium installed\n",
      "Libraries imported.\n"
     ]
    }
   ],
   "source": [
    "# Import libraries that will be used\n",
    "\n",
    "import requests # library to handle requests\n",
    "import pandas as pd # library for data analsysis\n",
    "import numpy as np # library to handle data in a vectorized manner\n",
    "import random # library for random number generation\n",
    "\n",
    "!conda install -c conda-forge geopy --yes \n",
    "from geopy.geocoders import Nominatim # module to convert an address into latitude and longitude values\n",
    "\n",
    "# libraries for displaying images\n",
    "from IPython.display import Image \n",
    "from IPython.core.display import HTML \n",
    "    \n",
    "# tranforming json file into a pandas dataframe library\n",
    "from pandas.io.json import json_normalize\n",
    "\n",
    "!conda install -c conda-forge folium=0.5.0 --yes\n",
    "import folium # plotting library\n",
    "\n",
    "print('Folium installed')\n",
    "print('Libraries imported.')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Solving environment: done\n",
      "\n",
      "## Package Plan ##\n",
      "\n",
      "  environment location: /opt/conda/envs/Python36\n",
      "\n",
      "  added / updated specs: \n",
      "    - beautifulsoup4\n",
      "\n",
      "\n",
      "The following packages will be downloaded:\n",
      "\n",
      "    package                    |            build\n",
      "    ---------------------------|-----------------\n",
      "    beautifulsoup4-4.9.0       |           py36_0         165 KB\n",
      "    openssl-1.1.1g             |       h7b6447c_0         3.8 MB\n",
      "    ------------------------------------------------------------\n",
      "                                           Total:         4.0 MB\n",
      "\n",
      "The following packages will be UPDATED:\n",
      "\n",
      "    beautifulsoup4:  4.7.1-py36_1                          --> 4.9.0-py36_0     \n",
      "    certifi:         2020.4.5.1-py36h9f0ad1d_0 conda-forge --> 2020.4.5.1-py36_0\n",
      "    openssl:         1.1.1g-h516909a_0         conda-forge --> 1.1.1g-h7b6447c_0\n",
      "\n",
      "The following packages will be DOWNGRADED:\n",
      "\n",
      "    ca-certificates: 2020.4.5.1-hecc5488_0     conda-forge --> 2020.1.1-0       \n",
      "\n",
      "\n",
      "Downloading and Extracting Packages\n",
      "beautifulsoup4-4.9.0 | 165 KB    | ##################################### | 100% \n",
      "openssl-1.1.1g       | 3.8 MB    | ##################################### | 100% \n",
      "Preparing transaction: done\n",
      "Verifying transaction: done\n",
      "Executing transaction: done\n"
     ]
    }
   ],
   "source": [
    "# Libraries Used for getting Neighborhood Data\n",
    "\n",
    "!conda install beautifulsoup4\n",
    "\n",
    "from bs4 import BeautifulSoup\n",
    "import csv"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Getting Neighborhood Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Neighbourhood</th>\n",
       "      <th>Latitude</th>\n",
       "      <th>Longitude</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [Neighbourhood, Latitude, Longitude]\n",
       "Index: []"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Analyzing using FourSquare Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Your credentails:\n",
      "CLIENT_ID: QX3QPLAJFTR1LQH3BGWSNPBPXZFPW4XDBUBDK3WB4XCLOSFX\n",
      "CLIENT_SECRET:FS0EPZR4HTWS2QQVIAJSQI2MVPJQGSHALV0NCFYBJVFW5YRK\n"
     ]
    }
   ],
   "source": [
    "CLIENT_ID = 'QX3QPLAJFTR1LQH3BGWSNPBPXZFPW4XDBUBDK3WB4XCLOSFX' # your Foursquare ID\n",
    "CLIENT_SECRET = 'FS0EPZR4HTWS2QQVIAJSQI2MVPJQGSHALV0NCFYBJVFW5YRK' # your Foursquare Secret\n",
    "VERSION = '20180604'\n",
    "LIMIT = 60\n",
    "print('Your credentails:')\n",
    "print('CLIENT_ID: ' + CLIENT_ID)\n",
    "print('CLIENT_SECRET:' + CLIENT_SECRET)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### Latitude and Longitude"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "latitude = -34.5453\n",
    "longitude = -58.4498"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Parrilla .... OK!\n"
     ]
    }
   ],
   "source": [
    "# Search for a Venue Category\n",
    "search_query = ('Parrilla')\n",
    "radius = 2000\n",
    "print(search_query + ' .... OK!')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'https://api.foursquare.com/v2/venues/search?client_id=QX3QPLAJFTR1LQH3BGWSNPBPXZFPW4XDBUBDK3WB4XCLOSFX&client_secret=FS0EPZR4HTWS2QQVIAJSQI2MVPJQGSHALV0NCFYBJVFW5YRK&ll=-34.5453,-58.4498&v=20180604&query=Parrilla&radius=2000&limit=60'"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Define Corresponding URL\n",
    "url = 'https://api.foursquare.com/v2/venues/search?client_id={}&client_secret={}&ll={},{}&v={}&query={}&radius={}&limit={}'.format(CLIENT_ID, CLIENT_SECRET, latitude, longitude, VERSION, search_query, radius, LIMIT)\n",
    "url"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'meta': {'code': 200, 'requestId': '5ea361e3a2e538001bb998d1'},\n",
       " 'response': {'venues': [{'id': '4dfabb87b61c6408772d39db',\n",
       "    'name': 'Parrilla El Cocacolero',\n",
       "    'location': {'address': 'Av. Costanera Norte Rafael Obligado s/n',\n",
       "     'lat': -34.54695412483968,\n",
       "     'lng': -58.430826246786566,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.54695412483968,\n",
       "       'lng': -58.430826246786566}],\n",
       "     'distance': 1749,\n",
       "     'postalCode': 'C1428DYC',\n",
       "     'cc': 'AR',\n",
       "     'city': 'Buenos Aires',\n",
       "     'state': 'Buenos Aires C.F.',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Av. Costanera Norte Rafael Obligado s/n',\n",
       "      'C1428DYC Buenos Aires',\n",
       "      'Buenos Aires C.F.',\n",
       "      'Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d1cb941735',\n",
       "      'name': 'Food Truck',\n",
       "      'pluralName': 'Food Trucks',\n",
       "      'shortName': 'Food Truck',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/streetfood_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '4c62e1147c9def3b2258d71c',\n",
       "    'name': 'La Esquina - Parrilla',\n",
       "    'location': {'address': 'Mariscal Antonio José de Sucre 1299',\n",
       "     'crossStreet': 'esq. Miñones',\n",
       "     'lat': -34.55732863895771,\n",
       "     'lng': -58.44392190976976,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.55732863895771,\n",
       "       'lng': -58.44392190976976}],\n",
       "     'distance': 1443,\n",
       "     'postalCode': 'C1428DUM',\n",
       "     'cc': 'AR',\n",
       "     'city': 'Buenos Aires',\n",
       "     'state': 'Buenos Aires C.F.',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Mariscal Antonio José de Sucre 1299 (esq. Miñones)',\n",
       "      'C1428DUM Belgrano',\n",
       "      'Buenos Aires C.F.',\n",
       "      'Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d1df931735',\n",
       "      'name': 'BBQ Joint',\n",
       "      'pluralName': 'BBQ Joints',\n",
       "      'shortName': 'BBQ',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/bbqalt_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '4ed18b56722e01c583c85a5c',\n",
       "    'name': 'Parrilla Besares',\n",
       "    'location': {'lat': -34.552620503100286,\n",
       "     'lng': -58.454556174122025,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.552620503100286,\n",
       "       'lng': -58.454556174122025}],\n",
       "     'distance': 924,\n",
       "     'cc': 'AR',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d1df931735',\n",
       "      'name': 'BBQ Joint',\n",
       "      'pluralName': 'BBQ Joints',\n",
       "      'shortName': 'BBQ',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/bbqalt_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '4c3a0a23dfb0e21e2772b1a8',\n",
       "    'name': 'Parrilla Juan y Juan',\n",
       "    'location': {'address': 'Arribenos 3600',\n",
       "     'crossStreet': 'Crisologo Larralde',\n",
       "     'lat': -34.5450293377858,\n",
       "     'lng': -58.46046015606094,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.5450293377858,\n",
       "       'lng': -58.46046015606094}],\n",
       "     'distance': 977,\n",
       "     'cc': 'AR',\n",
       "     'city': 'Capital Federal',\n",
       "     'state': 'Buenos Aires',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Arribenos 3600 (Crisologo Larralde)',\n",
       "      'Capital Federal',\n",
       "      'Buenos Aires',\n",
       "      'Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d1df931735',\n",
       "      'name': 'BBQ Joint',\n",
       "      'pluralName': 'BBQ Joints',\n",
       "      'shortName': 'BBQ',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/bbqalt_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '4d61b0f5ef378cfa5c318ea6',\n",
       "    'name': 'Parrilla Lumay',\n",
       "    'location': {'address': 'Grecia',\n",
       "     'crossStreet': 'Manuela Pedraza',\n",
       "     'lat': -34.5464204,\n",
       "     'lng': -58.4627994,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.5464204,\n",
       "       'lng': -58.4627994}],\n",
       "     'distance': 1198,\n",
       "     'postalCode': '1429',\n",
       "     'cc': 'AR',\n",
       "     'city': 'Buenos Aires',\n",
       "     'state': 'Cap. Fed.',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Grecia (Manuela Pedraza)',\n",
       "      '1429 Buenos Aires',\n",
       "      'Cap. Fed.',\n",
       "      'Argentina']},\n",
       "    'categories': [],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '4ba02227f964a520975c37e3',\n",
       "    'name': 'Gran Parrilla Crámer',\n",
       "    'location': {'address': 'Av. Dr. Ricardo Balbín 2782',\n",
       "     'crossStreet': 'esq. Manuel Ugarte',\n",
       "     'lat': -34.56074433569633,\n",
       "     'lng': -58.4699299445716,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.56074433569633,\n",
       "       'lng': -58.4699299445716}],\n",
       "     'distance': 2522,\n",
       "     'postalCode': 'C1428CVR',\n",
       "     'cc': 'AR',\n",
       "     'city': 'Buenos Aires',\n",
       "     'state': 'Buenos Aires C.F.',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Av. Dr. Ricardo Balbín 2782 (esq. Manuel Ugarte)',\n",
       "      'C1428CVR Buenos Aires',\n",
       "      'Buenos Aires C.F.',\n",
       "      'Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d1df931735',\n",
       "      'name': 'BBQ Joint',\n",
       "      'pluralName': 'BBQ Joints',\n",
       "      'shortName': 'BBQ',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/bbqalt_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '54a6a997498ec4ba52ab0160',\n",
       "    'name': 'Parrilla Villera Inn',\n",
       "    'location': {'address': 'Ohiggins 2845',\n",
       "     'crossStreet': 'Av Congreso',\n",
       "     'lat': -34.55330579578187,\n",
       "     'lng': -58.45898273823036,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.55330579578187,\n",
       "       'lng': -58.45898273823036}],\n",
       "     'distance': 1226,\n",
       "     'cc': 'AR',\n",
       "     'city': 'Buenos Aires',\n",
       "     'state': 'Buenos Aires C.F.',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Ohiggins 2845 (Av Congreso)',\n",
       "      'Buenos Aires',\n",
       "      'Buenos Aires C.F.',\n",
       "      'Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d1df931735',\n",
       "      'name': 'BBQ Joint',\n",
       "      'pluralName': 'BBQ Joints',\n",
       "      'shortName': 'BBQ',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/bbqalt_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '5151c6afe4b06114b19467b4',\n",
       "    'name': 'Parrilla de la Barrera',\n",
       "    'location': {'address': 'Arribeños 2108',\n",
       "     'crossStreet': 'esq. Juramento',\n",
       "     'lat': -34.557947,\n",
       "     'lng': -58.450354,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.557947,\n",
       "       'lng': -58.450354}],\n",
       "     'distance': 1408,\n",
       "     'postalCode': 'C1428APB',\n",
       "     'cc': 'AR',\n",
       "     'city': 'Buenos Aires',\n",
       "     'state': 'Buenos Aires C.F.',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Arribeños 2108 (esq. Juramento)',\n",
       "      'C1428APB Buenos Aires',\n",
       "      'Buenos Aires C.F.',\n",
       "      'Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d1df931735',\n",
       "      'name': 'BBQ Joint',\n",
       "      'pluralName': 'BBQ Joints',\n",
       "      'shortName': 'BBQ',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/bbqalt_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '4c464668f1b5c9b62a1d79ef',\n",
       "    'name': 'Parrilla Al Carbon',\n",
       "    'location': {'lat': -34.558556146829886,\n",
       "     'lng': -58.449806449543,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.558556146829886,\n",
       "       'lng': -58.449806449543}],\n",
       "     'distance': 1475,\n",
       "     'cc': 'AR',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d107941735',\n",
       "      'name': 'Argentinian Restaurant',\n",
       "      'pluralName': 'Argentinian Restaurants',\n",
       "      'shortName': 'Argentinian',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/argentinian_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '539c720b498e06f4cc766a06',\n",
       "    'name': 'Mi Pinche Pincha Parrilla',\n",
       "    'location': {'lat': -34.55142593383789,\n",
       "     'lng': -58.443450927734375,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.55142593383789,\n",
       "       'lng': -58.443450927734375}],\n",
       "     'distance': 896,\n",
       "     'cc': 'AR',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Argentina']},\n",
       "    'categories': [{'id': '4d954b06a243a5684965b473',\n",
       "      'name': 'Residential Building (Apartment / Condo)',\n",
       "      'pluralName': 'Residential Buildings (Apartments / Condos)',\n",
       "      'shortName': 'Residential',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/building/apartment_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '4da657be0cb6ba7974d50a59',\n",
       "    'name': 'Parrilla al Paso',\n",
       "    'location': {'address': 'Ciudad de la Paz 2009',\n",
       "     'lat': -34.56079614655111,\n",
       "     'lng': -58.45688651019727,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.56079614655111,\n",
       "       'lng': -58.45688651019727}],\n",
       "     'distance': 1843,\n",
       "     'cc': 'AR',\n",
       "     'city': 'Capital Federal',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Ciudad de la Paz 2009',\n",
       "      'Capital Federal',\n",
       "      'Argentina']},\n",
       "    'categories': [],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '51db5eba498ed64a0f793e38',\n",
       "    'name': 'Parrilla Butler',\n",
       "    'location': {'lat': -34.557403564453125,\n",
       "     'lng': -58.464656829833984,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.557403564453125,\n",
       "       'lng': -58.464656829833984}],\n",
       "     'distance': 1915,\n",
       "     'cc': 'AR',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d1df931735',\n",
       "      'name': 'BBQ Joint',\n",
       "      'pluralName': 'BBQ Joints',\n",
       "      'shortName': 'BBQ',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/bbqalt_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '4d3785966eef5481148e3848',\n",
       "    'name': 'Besares Parrilla Urbana',\n",
       "    'location': {'address': '11 de Septiembre 3301',\n",
       "     'crossStreet': 'esq. Besares',\n",
       "     'lat': -34.547819,\n",
       "     'lng': -58.459678,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.547819,\n",
       "       'lng': -58.459678}],\n",
       "     'distance': 948,\n",
       "     'postalCode': '1429',\n",
       "     'cc': 'AR',\n",
       "     'neighborhood': 'Núñez, Buenos Aires, Buenos Aires F.D.',\n",
       "     'city': 'Buenos Aires',\n",
       "     'state': 'Buenos Aires C.F.',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['11 de Septiembre 3301 (esq. Besares)',\n",
       "      '1429 Buenos Aires',\n",
       "      'Buenos Aires C.F.',\n",
       "      'Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d107941735',\n",
       "      'name': 'Argentinian Restaurant',\n",
       "      'pluralName': 'Argentinian Restaurants',\n",
       "      'shortName': 'Argentinian',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/argentinian_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '4c43990f36d6a593666769a8',\n",
       "    'name': 'Parrilla Stoppy',\n",
       "    'location': {'address': 'Moldes 2288',\n",
       "     'crossStreet': 'Olazabal',\n",
       "     'lat': -34.561928,\n",
       "     'lng': -58.460904,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.561928,\n",
       "       'lng': -58.460904}],\n",
       "     'distance': 2112,\n",
       "     'cc': 'AR',\n",
       "     'city': 'Ciudad Autónoma de Buenos Aire',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Moldes 2288 (Olazabal)',\n",
       "      'Ciudad Autónoma de Buenos Aire',\n",
       "      'Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d107941735',\n",
       "      'name': 'Argentinian Restaurant',\n",
       "      'pluralName': 'Argentinian Restaurants',\n",
       "      'shortName': 'Argentinian',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/argentinian_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '5e362a7104e00e000849a180',\n",
       "    'name': 'Parrilla Un Clasico',\n",
       "    'location': {'address': 'Roque Pérez 2801',\n",
       "     'crossStreet': 'esq. Miguel Ugarte',\n",
       "     'lat': -34.562032,\n",
       "     'lng': -58.473095,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.562032,\n",
       "       'lng': -58.473095}],\n",
       "     'distance': 2833,\n",
       "     'postalCode': 'C1430FBG',\n",
       "     'cc': 'AR',\n",
       "     'city': 'Buenos Aires',\n",
       "     'state': 'Buenos Aires C.F.',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Roque Pérez 2801 (esq. Miguel Ugarte)',\n",
       "      'C1430FBG Buenos Aires',\n",
       "      'Buenos Aires C.F.',\n",
       "      'Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d1df931735',\n",
       "      'name': 'BBQ Joint',\n",
       "      'pluralName': 'BBQ Joints',\n",
       "      'shortName': 'BBQ',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/bbqalt_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '529ae25711d299f45d8471b7',\n",
       "    'name': 'Carmín Parrilla Urbana',\n",
       "    'location': {'lat': -34.5590355433524,\n",
       "     'lng': -58.4532140102237,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.5590355433524,\n",
       "       'lng': -58.4532140102237}],\n",
       "     'distance': 1560,\n",
       "     'postalCode': '1428',\n",
       "     'cc': 'AR',\n",
       "     'city': 'Buenos Aires',\n",
       "     'state': 'Buenos Aires C.F.',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['1428 Buenos Aires',\n",
       "      'Buenos Aires C.F.',\n",
       "      'Argentina']},\n",
       "    'categories': [],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '4fc27a5fe4b0c9a9f1c15df3',\n",
       "    'name': 'La Parrilla De Tito',\n",
       "    'location': {'lat': -34.55225148850475,\n",
       "     'lng': -58.46346537516845,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.55225148850475,\n",
       "       'lng': -58.46346537516845}],\n",
       "     'distance': 1472,\n",
       "     'cc': 'AR',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d1df931735',\n",
       "      'name': 'BBQ Joint',\n",
       "      'pluralName': 'BBQ Joints',\n",
       "      'shortName': 'BBQ',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/bbqalt_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '4ff4714be4b01a84ec7ddfdc',\n",
       "    'name': 'Placeres Criollos - Parrilla',\n",
       "    'location': {'address': 'Mendoza 2450',\n",
       "     'lat': -34.561395,\n",
       "     'lng': -58.458107,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.561395,\n",
       "       'lng': -58.458107}],\n",
       "     'distance': 1946,\n",
       "     'cc': 'AR',\n",
       "     'city': 'Capital Federal',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Mendoza 2450', 'Capital Federal', 'Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d1df931735',\n",
       "      'name': 'BBQ Joint',\n",
       "      'pluralName': 'BBQ Joints',\n",
       "      'shortName': 'BBQ',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/bbqalt_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '4dcff255d164679b8d246e21',\n",
       "    'name': 'Emperador parrilla',\n",
       "    'location': {'address': 'Av Rafael Obligado Costanera',\n",
       "     'lat': -34.54719648,\n",
       "     'lng': -58.43073665,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.54719648,\n",
       "       'lng': -58.43073665}],\n",
       "     'distance': 1760,\n",
       "     'cc': 'AR',\n",
       "     'city': 'Buenos Aires',\n",
       "     'state': 'Buenos Aires C.F.',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Av Rafael Obligado Costanera',\n",
       "      'Buenos Aires',\n",
       "      'Buenos Aires C.F.',\n",
       "      'Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d16c941735',\n",
       "      'name': 'Burger Joint',\n",
       "      'pluralName': 'Burger Joints',\n",
       "      'shortName': 'Burgers',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/burger_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '53361af1498ebdf6b1fddfb9',\n",
       "    'name': 'Besares Parrilla Urbana',\n",
       "    'location': {'address': '11 de septiembre 4098',\n",
       "     'crossStreet': 'esq. Besares',\n",
       "     'lat': -34.54179652264518,\n",
       "     'lng': -58.46415388553262,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.54179652264518,\n",
       "       'lng': -58.46415388553262}],\n",
       "     'distance': 1372,\n",
       "     'postalCode': 'C1429BIZ',\n",
       "     'cc': 'AR',\n",
       "     'neighborhood': 'Núñez, Buenos Aires, Buenos Aires F.D.',\n",
       "     'city': 'Buenos Aires',\n",
       "     'state': 'Buenos Aires C.F.',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['11 de septiembre 4098 (esq. Besares)',\n",
       "      'C1429BIZ Buenos Aires',\n",
       "      'Buenos Aires C.F.',\n",
       "      'Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d1df931735',\n",
       "      'name': 'BBQ Joint',\n",
       "      'pluralName': 'BBQ Joints',\n",
       "      'shortName': 'BBQ',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/bbqalt_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '4cd4c6c32944b1f7e55359ec',\n",
       "    'name': 'La parrilla de Fede',\n",
       "    'location': {'address': 'Freire 2550',\n",
       "     'crossStreet': 'Monroe',\n",
       "     'lat': -34.56241444933289,\n",
       "     'lng': -58.468154187359126,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.56241444933289,\n",
       "       'lng': -58.468154187359126}],\n",
       "     'distance': 2541,\n",
       "     'cc': 'AR',\n",
       "     'city': 'Belgrano',\n",
       "     'state': 'Buenos Aires C.F.',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Freire 2550 (Monroe)',\n",
       "      'Belgrano',\n",
       "      'Buenos Aires C.F.',\n",
       "      'Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d1df931735',\n",
       "      'name': 'BBQ Joint',\n",
       "      'pluralName': 'BBQ Joints',\n",
       "      'shortName': 'BBQ',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/bbqalt_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '55e66874498ef95fcdeca8fb',\n",
       "    'name': 'El Paisano Kosher House',\n",
       "    'location': {'address': \"O'Higgins 2358\",\n",
       "     'crossStreet': 'esq. Blanco Encalada',\n",
       "     'lat': -34.55759018451175,\n",
       "     'lng': -58.455140590667725,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.55759018451175,\n",
       "       'lng': -58.455140590667725}],\n",
       "     'distance': 1453,\n",
       "     'postalCode': '1428',\n",
       "     'cc': 'AR',\n",
       "     'city': 'Buenos Aires',\n",
       "     'state': 'Buenos Aires C.F.',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': [\"O'Higgins 2358 (esq. Blanco Encalada)\",\n",
       "      '1428 Buenos Aires',\n",
       "      'Buenos Aires C.F.',\n",
       "      'Argentina']},\n",
       "    'categories': [{'id': '52e81612bcbc57f1066b79fc',\n",
       "      'name': 'Kosher Restaurant',\n",
       "      'pluralName': 'Kosher Restaurants',\n",
       "      'shortName': 'Kosher',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/default_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '4b4d029cf964a520a2c726e3',\n",
       "    'name': 'Los Arribeños',\n",
       "    'location': {'address': 'Arribeños 2707',\n",
       "     'crossStreet': 'esq. Manuel Ugarte',\n",
       "     'lat': -34.552582121455025,\n",
       "     'lng': -58.454771041402125,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.552582121455025,\n",
       "       'lng': -58.454771041402125}],\n",
       "     'distance': 929,\n",
       "     'postalCode': 'C1428APM',\n",
       "     'cc': 'AR',\n",
       "     'city': 'Buenos Aires',\n",
       "     'state': 'Buenos Aires C.F.',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Arribeños 2707 (esq. Manuel Ugarte)',\n",
       "      'C1428APM Belgrano',\n",
       "      'Buenos Aires C.F.',\n",
       "      'Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d1df931735',\n",
       "      'name': 'BBQ Joint',\n",
       "      'pluralName': 'BBQ Joints',\n",
       "      'shortName': 'BBQ',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/bbqalt_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'venuePage': {'id': '151444037'},\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '4bdcc8353904a59343c24f9e',\n",
       "    'name': 'Checho',\n",
       "    'location': {'address': 'Ramallo 1781',\n",
       "     'lat': -34.53980231016713,\n",
       "     'lng': -58.466433392835604,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.53980231016713,\n",
       "       'lng': -58.466433392835604}],\n",
       "     'distance': 1643,\n",
       "     'postalCode': '1429',\n",
       "     'cc': 'AR',\n",
       "     'city': 'Buenos Aires',\n",
       "     'state': 'Buenos Aires C.F.',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Ramallo 1781',\n",
       "      '1429 Buenos Aires',\n",
       "      'Buenos Aires C.F.',\n",
       "      'Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d1cc941735',\n",
       "      'name': 'Steakhouse',\n",
       "      'pluralName': 'Steakhouses',\n",
       "      'shortName': 'Steakhouse',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/steakhouse_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False},\n",
       "   {'id': '4fb3df39e4b076d9e9d12f38',\n",
       "    'name': 'Carmín',\n",
       "    'location': {'address': 'Juramento 1301',\n",
       "     'crossStreet': 'esquina Miñones',\n",
       "     'lat': -34.5554008034211,\n",
       "     'lng': -58.44559010263614,\n",
       "     'labeledLatLngs': [{'label': 'display',\n",
       "       'lat': -34.5554008034211,\n",
       "       'lng': -58.44559010263614}],\n",
       "     'distance': 1188,\n",
       "     'postalCode': 'C1428DMO',\n",
       "     'cc': 'AR',\n",
       "     'city': 'Belgrano',\n",
       "     'state': 'Buenos Aires C.F.',\n",
       "     'country': 'Argentina',\n",
       "     'formattedAddress': ['Juramento 1301 (esquina Miñones)',\n",
       "      'C1428DMO Belgrano',\n",
       "      'Buenos Aires C.F.',\n",
       "      'Argentina']},\n",
       "    'categories': [{'id': '4bf58dd8d48988d107941735',\n",
       "      'name': 'Argentinian Restaurant',\n",
       "      'pluralName': 'Argentinian Restaurants',\n",
       "      'shortName': 'Argentinian',\n",
       "      'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/food/argentinian_',\n",
       "       'suffix': '.png'},\n",
       "      'primary': True}],\n",
       "    'referralId': 'v-1587765950',\n",
       "    'hasPerk': False}]}}"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set Request and Examin Results\n",
    "results = requests.get(url).json()\n",
    "results"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### Get relevant part of JSON and transform it into a *pandas* dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>categories</th>\n",
       "      <th>hasPerk</th>\n",
       "      <th>id</th>\n",
       "      <th>location.address</th>\n",
       "      <th>location.cc</th>\n",
       "      <th>location.city</th>\n",
       "      <th>location.country</th>\n",
       "      <th>location.crossStreet</th>\n",
       "      <th>location.distance</th>\n",
       "      <th>location.formattedAddress</th>\n",
       "      <th>location.labeledLatLngs</th>\n",
       "      <th>location.lat</th>\n",
       "      <th>location.lng</th>\n",
       "      <th>location.neighborhood</th>\n",
       "      <th>location.postalCode</th>\n",
       "      <th>location.state</th>\n",
       "      <th>name</th>\n",
       "      <th>referralId</th>\n",
       "      <th>venuePage.id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>[{'id': '4bf58dd8d48988d1cb941735', 'name': 'F...</td>\n",
       "      <td>False</td>\n",
       "      <td>4dfabb87b61c6408772d39db</td>\n",
       "      <td>Av. Costanera Norte Rafael Obligado s/n</td>\n",
       "      <td>AR</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1749</td>\n",
       "      <td>[Av. Costanera Norte Rafael Obligado s/n, C142...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5469541248396...</td>\n",
       "      <td>-34.546954</td>\n",
       "      <td>-58.430826</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C1428DYC</td>\n",
       "      <td>Buenos Aires C.F.</td>\n",
       "      <td>Parrilla El Cocacolero</td>\n",
       "      <td>v-1587765950</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>[{'id': '4bf58dd8d48988d1df931735', 'name': 'B...</td>\n",
       "      <td>False</td>\n",
       "      <td>4c62e1147c9def3b2258d71c</td>\n",
       "      <td>Mariscal Antonio José de Sucre 1299</td>\n",
       "      <td>AR</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>esq. Miñones</td>\n",
       "      <td>1443</td>\n",
       "      <td>[Mariscal Antonio José de Sucre 1299 (esq. Miñ...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5573286389577...</td>\n",
       "      <td>-34.557329</td>\n",
       "      <td>-58.443922</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C1428DUM</td>\n",
       "      <td>Buenos Aires C.F.</td>\n",
       "      <td>La Esquina - Parrilla</td>\n",
       "      <td>v-1587765950</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>[{'id': '4bf58dd8d48988d1df931735', 'name': 'B...</td>\n",
       "      <td>False</td>\n",
       "      <td>4ed18b56722e01c583c85a5c</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AR</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>NaN</td>\n",
       "      <td>924</td>\n",
       "      <td>[Argentina]</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5526205031002...</td>\n",
       "      <td>-34.552621</td>\n",
       "      <td>-58.454556</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Parrilla Besares</td>\n",
       "      <td>v-1587765950</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>[{'id': '4bf58dd8d48988d1df931735', 'name': 'B...</td>\n",
       "      <td>False</td>\n",
       "      <td>4c3a0a23dfb0e21e2772b1a8</td>\n",
       "      <td>Arribenos 3600</td>\n",
       "      <td>AR</td>\n",
       "      <td>Capital Federal</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>Crisologo Larralde</td>\n",
       "      <td>977</td>\n",
       "      <td>[Arribenos 3600 (Crisologo Larralde), Capital ...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5450293377858...</td>\n",
       "      <td>-34.545029</td>\n",
       "      <td>-58.460460</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Parrilla Juan y Juan</td>\n",
       "      <td>v-1587765950</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>[]</td>\n",
       "      <td>False</td>\n",
       "      <td>4d61b0f5ef378cfa5c318ea6</td>\n",
       "      <td>Grecia</td>\n",
       "      <td>AR</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>Manuela Pedraza</td>\n",
       "      <td>1198</td>\n",
       "      <td>[Grecia (Manuela Pedraza), 1429 Buenos Aires, ...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5464204, 'lng...</td>\n",
       "      <td>-34.546420</td>\n",
       "      <td>-58.462799</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1429</td>\n",
       "      <td>Cap. Fed.</td>\n",
       "      <td>Parrilla Lumay</td>\n",
       "      <td>v-1587765950</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                          categories  hasPerk  \\\n",
       "0  [{'id': '4bf58dd8d48988d1cb941735', 'name': 'F...    False   \n",
       "1  [{'id': '4bf58dd8d48988d1df931735', 'name': 'B...    False   \n",
       "2  [{'id': '4bf58dd8d48988d1df931735', 'name': 'B...    False   \n",
       "3  [{'id': '4bf58dd8d48988d1df931735', 'name': 'B...    False   \n",
       "4                                                 []    False   \n",
       "\n",
       "                         id                         location.address  \\\n",
       "0  4dfabb87b61c6408772d39db  Av. Costanera Norte Rafael Obligado s/n   \n",
       "1  4c62e1147c9def3b2258d71c      Mariscal Antonio José de Sucre 1299   \n",
       "2  4ed18b56722e01c583c85a5c                                      NaN   \n",
       "3  4c3a0a23dfb0e21e2772b1a8                           Arribenos 3600   \n",
       "4  4d61b0f5ef378cfa5c318ea6                                   Grecia   \n",
       "\n",
       "  location.cc    location.city location.country location.crossStreet  \\\n",
       "0          AR     Buenos Aires        Argentina                  NaN   \n",
       "1          AR     Buenos Aires        Argentina         esq. Miñones   \n",
       "2          AR              NaN        Argentina                  NaN   \n",
       "3          AR  Capital Federal        Argentina   Crisologo Larralde   \n",
       "4          AR     Buenos Aires        Argentina      Manuela Pedraza   \n",
       "\n",
       "   location.distance                          location.formattedAddress  \\\n",
       "0               1749  [Av. Costanera Norte Rafael Obligado s/n, C142...   \n",
       "1               1443  [Mariscal Antonio José de Sucre 1299 (esq. Miñ...   \n",
       "2                924                                        [Argentina]   \n",
       "3                977  [Arribenos 3600 (Crisologo Larralde), Capital ...   \n",
       "4               1198  [Grecia (Manuela Pedraza), 1429 Buenos Aires, ...   \n",
       "\n",
       "                             location.labeledLatLngs  location.lat  \\\n",
       "0  [{'label': 'display', 'lat': -34.5469541248396...    -34.546954   \n",
       "1  [{'label': 'display', 'lat': -34.5573286389577...    -34.557329   \n",
       "2  [{'label': 'display', 'lat': -34.5526205031002...    -34.552621   \n",
       "3  [{'label': 'display', 'lat': -34.5450293377858...    -34.545029   \n",
       "4  [{'label': 'display', 'lat': -34.5464204, 'lng...    -34.546420   \n",
       "\n",
       "   location.lng location.neighborhood location.postalCode     location.state  \\\n",
       "0    -58.430826                   NaN            C1428DYC  Buenos Aires C.F.   \n",
       "1    -58.443922                   NaN            C1428DUM  Buenos Aires C.F.   \n",
       "2    -58.454556                   NaN                 NaN                NaN   \n",
       "3    -58.460460                   NaN                 NaN       Buenos Aires   \n",
       "4    -58.462799                   NaN                1429          Cap. Fed.   \n",
       "\n",
       "                     name    referralId venuePage.id  \n",
       "0  Parrilla El Cocacolero  v-1587765950          NaN  \n",
       "1   La Esquina - Parrilla  v-1587765950          NaN  \n",
       "2        Parrilla Besares  v-1587765950          NaN  \n",
       "3    Parrilla Juan y Juan  v-1587765950          NaN  \n",
       "4          Parrilla Lumay  v-1587765950          NaN  "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# assign relevant part of JSON to venues\n",
    "venues = results['response']['venues']\n",
    "\n",
    "# tranform venues into a dataframe\n",
    "dataframe = json_normalize(venues)\n",
    "dataframe.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### Define information of interest and filter dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>name</th>\n",
       "      <th>categories</th>\n",
       "      <th>address</th>\n",
       "      <th>cc</th>\n",
       "      <th>city</th>\n",
       "      <th>country</th>\n",
       "      <th>crossStreet</th>\n",
       "      <th>distance</th>\n",
       "      <th>formattedAddress</th>\n",
       "      <th>labeledLatLngs</th>\n",
       "      <th>lat</th>\n",
       "      <th>lng</th>\n",
       "      <th>neighborhood</th>\n",
       "      <th>postalCode</th>\n",
       "      <th>state</th>\n",
       "      <th>id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Parrilla El Cocacolero</td>\n",
       "      <td>Food Truck</td>\n",
       "      <td>Av. Costanera Norte Rafael Obligado s/n</td>\n",
       "      <td>AR</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1749</td>\n",
       "      <td>[Av. Costanera Norte Rafael Obligado s/n, C142...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5469541248396...</td>\n",
       "      <td>-34.546954</td>\n",
       "      <td>-58.430826</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C1428DYC</td>\n",
       "      <td>Buenos Aires C.F.</td>\n",
       "      <td>4dfabb87b61c6408772d39db</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>La Esquina - Parrilla</td>\n",
       "      <td>BBQ Joint</td>\n",
       "      <td>Mariscal Antonio José de Sucre 1299</td>\n",
       "      <td>AR</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>esq. Miñones</td>\n",
       "      <td>1443</td>\n",
       "      <td>[Mariscal Antonio José de Sucre 1299 (esq. Miñ...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5573286389577...</td>\n",
       "      <td>-34.557329</td>\n",
       "      <td>-58.443922</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C1428DUM</td>\n",
       "      <td>Buenos Aires C.F.</td>\n",
       "      <td>4c62e1147c9def3b2258d71c</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Parrilla Besares</td>\n",
       "      <td>BBQ Joint</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AR</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>NaN</td>\n",
       "      <td>924</td>\n",
       "      <td>[Argentina]</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5526205031002...</td>\n",
       "      <td>-34.552621</td>\n",
       "      <td>-58.454556</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4ed18b56722e01c583c85a5c</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Parrilla Juan y Juan</td>\n",
       "      <td>BBQ Joint</td>\n",
       "      <td>Arribenos 3600</td>\n",
       "      <td>AR</td>\n",
       "      <td>Capital Federal</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>Crisologo Larralde</td>\n",
       "      <td>977</td>\n",
       "      <td>[Arribenos 3600 (Crisologo Larralde), Capital ...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5450293377858...</td>\n",
       "      <td>-34.545029</td>\n",
       "      <td>-58.460460</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>4c3a0a23dfb0e21e2772b1a8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Parrilla Lumay</td>\n",
       "      <td>None</td>\n",
       "      <td>Grecia</td>\n",
       "      <td>AR</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>Manuela Pedraza</td>\n",
       "      <td>1198</td>\n",
       "      <td>[Grecia (Manuela Pedraza), 1429 Buenos Aires, ...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5464204, 'lng...</td>\n",
       "      <td>-34.546420</td>\n",
       "      <td>-58.462799</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1429</td>\n",
       "      <td>Cap. Fed.</td>\n",
       "      <td>4d61b0f5ef378cfa5c318ea6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Gran Parrilla Crámer</td>\n",
       "      <td>BBQ Joint</td>\n",
       "      <td>Av. Dr. Ricardo Balbín 2782</td>\n",
       "      <td>AR</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>esq. Manuel Ugarte</td>\n",
       "      <td>2522</td>\n",
       "      <td>[Av. Dr. Ricardo Balbín 2782 (esq. Manuel Ugar...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5607443356963...</td>\n",
       "      <td>-34.560744</td>\n",
       "      <td>-58.469930</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C1428CVR</td>\n",
       "      <td>Buenos Aires C.F.</td>\n",
       "      <td>4ba02227f964a520975c37e3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Parrilla Villera Inn</td>\n",
       "      <td>BBQ Joint</td>\n",
       "      <td>Ohiggins 2845</td>\n",
       "      <td>AR</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>Av Congreso</td>\n",
       "      <td>1226</td>\n",
       "      <td>[Ohiggins 2845 (Av Congreso), Buenos Aires, Bu...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5533057957818...</td>\n",
       "      <td>-34.553306</td>\n",
       "      <td>-58.458983</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Buenos Aires C.F.</td>\n",
       "      <td>54a6a997498ec4ba52ab0160</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Parrilla de la Barrera</td>\n",
       "      <td>BBQ Joint</td>\n",
       "      <td>Arribeños 2108</td>\n",
       "      <td>AR</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>esq. Juramento</td>\n",
       "      <td>1408</td>\n",
       "      <td>[Arribeños 2108 (esq. Juramento), C1428APB Bue...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.557947, 'lng'...</td>\n",
       "      <td>-34.557947</td>\n",
       "      <td>-58.450354</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C1428APB</td>\n",
       "      <td>Buenos Aires C.F.</td>\n",
       "      <td>5151c6afe4b06114b19467b4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Parrilla Al Carbon</td>\n",
       "      <td>Argentinian Restaurant</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AR</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1475</td>\n",
       "      <td>[Argentina]</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5585561468298...</td>\n",
       "      <td>-34.558556</td>\n",
       "      <td>-58.449806</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4c464668f1b5c9b62a1d79ef</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Mi Pinche Pincha Parrilla</td>\n",
       "      <td>Residential Building (Apartment / Condo)</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AR</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>NaN</td>\n",
       "      <td>896</td>\n",
       "      <td>[Argentina]</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5514259338378...</td>\n",
       "      <td>-34.551426</td>\n",
       "      <td>-58.443451</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>539c720b498e06f4cc766a06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Parrilla al Paso</td>\n",
       "      <td>None</td>\n",
       "      <td>Ciudad de la Paz 2009</td>\n",
       "      <td>AR</td>\n",
       "      <td>Capital Federal</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1843</td>\n",
       "      <td>[Ciudad de la Paz 2009, Capital Federal, Argen...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5607961465511...</td>\n",
       "      <td>-34.560796</td>\n",
       "      <td>-58.456887</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4da657be0cb6ba7974d50a59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Parrilla Butler</td>\n",
       "      <td>BBQ Joint</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AR</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1915</td>\n",
       "      <td>[Argentina]</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5574035644531...</td>\n",
       "      <td>-34.557404</td>\n",
       "      <td>-58.464657</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51db5eba498ed64a0f793e38</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Besares Parrilla Urbana</td>\n",
       "      <td>Argentinian Restaurant</td>\n",
       "      <td>11 de Septiembre 3301</td>\n",
       "      <td>AR</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>esq. Besares</td>\n",
       "      <td>948</td>\n",
       "      <td>[11 de Septiembre 3301 (esq. Besares), 1429 Bu...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.547819, 'lng'...</td>\n",
       "      <td>-34.547819</td>\n",
       "      <td>-58.459678</td>\n",
       "      <td>Núñez, Buenos Aires, Buenos Aires F.D.</td>\n",
       "      <td>1429</td>\n",
       "      <td>Buenos Aires C.F.</td>\n",
       "      <td>4d3785966eef5481148e3848</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Parrilla Stoppy</td>\n",
       "      <td>Argentinian Restaurant</td>\n",
       "      <td>Moldes 2288</td>\n",
       "      <td>AR</td>\n",
       "      <td>Ciudad Autónoma de Buenos Aire</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>Olazabal</td>\n",
       "      <td>2112</td>\n",
       "      <td>[Moldes 2288 (Olazabal), Ciudad Autónoma de Bu...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.561928, 'lng'...</td>\n",
       "      <td>-34.561928</td>\n",
       "      <td>-58.460904</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4c43990f36d6a593666769a8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Parrilla Un Clasico</td>\n",
       "      <td>BBQ Joint</td>\n",
       "      <td>Roque Pérez 2801</td>\n",
       "      <td>AR</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>esq. Miguel Ugarte</td>\n",
       "      <td>2833</td>\n",
       "      <td>[Roque Pérez 2801 (esq. Miguel Ugarte), C1430F...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.562032, 'lng'...</td>\n",
       "      <td>-34.562032</td>\n",
       "      <td>-58.473095</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C1430FBG</td>\n",
       "      <td>Buenos Aires C.F.</td>\n",
       "      <td>5e362a7104e00e000849a180</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Carmín Parrilla Urbana</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AR</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1560</td>\n",
       "      <td>[1428 Buenos Aires, Buenos Aires C.F., Argentina]</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5590355433524...</td>\n",
       "      <td>-34.559036</td>\n",
       "      <td>-58.453214</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1428</td>\n",
       "      <td>Buenos Aires C.F.</td>\n",
       "      <td>529ae25711d299f45d8471b7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>La Parrilla De Tito</td>\n",
       "      <td>BBQ Joint</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AR</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1472</td>\n",
       "      <td>[Argentina]</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5522514885047...</td>\n",
       "      <td>-34.552251</td>\n",
       "      <td>-58.463465</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4fc27a5fe4b0c9a9f1c15df3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Placeres Criollos - Parrilla</td>\n",
       "      <td>BBQ Joint</td>\n",
       "      <td>Mendoza 2450</td>\n",
       "      <td>AR</td>\n",
       "      <td>Capital Federal</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1946</td>\n",
       "      <td>[Mendoza 2450, Capital Federal, Argentina]</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.561395, 'lng'...</td>\n",
       "      <td>-34.561395</td>\n",
       "      <td>-58.458107</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4ff4714be4b01a84ec7ddfdc</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Emperador parrilla</td>\n",
       "      <td>Burger Joint</td>\n",
       "      <td>Av Rafael Obligado Costanera</td>\n",
       "      <td>AR</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1760</td>\n",
       "      <td>[Av Rafael Obligado Costanera, Buenos Aires, B...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.54719648, 'ln...</td>\n",
       "      <td>-34.547196</td>\n",
       "      <td>-58.430737</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Buenos Aires C.F.</td>\n",
       "      <td>4dcff255d164679b8d246e21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Besares Parrilla Urbana</td>\n",
       "      <td>BBQ Joint</td>\n",
       "      <td>11 de septiembre 4098</td>\n",
       "      <td>AR</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>esq. Besares</td>\n",
       "      <td>1372</td>\n",
       "      <td>[11 de septiembre 4098 (esq. Besares), C1429BI...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5417965226451...</td>\n",
       "      <td>-34.541797</td>\n",
       "      <td>-58.464154</td>\n",
       "      <td>Núñez, Buenos Aires, Buenos Aires F.D.</td>\n",
       "      <td>C1429BIZ</td>\n",
       "      <td>Buenos Aires C.F.</td>\n",
       "      <td>53361af1498ebdf6b1fddfb9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>La parrilla de Fede</td>\n",
       "      <td>BBQ Joint</td>\n",
       "      <td>Freire 2550</td>\n",
       "      <td>AR</td>\n",
       "      <td>Belgrano</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>Monroe</td>\n",
       "      <td>2541</td>\n",
       "      <td>[Freire 2550 (Monroe), Belgrano, Buenos Aires ...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5624144493328...</td>\n",
       "      <td>-34.562414</td>\n",
       "      <td>-58.468154</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Buenos Aires C.F.</td>\n",
       "      <td>4cd4c6c32944b1f7e55359ec</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>El Paisano Kosher House</td>\n",
       "      <td>Kosher Restaurant</td>\n",
       "      <td>O'Higgins 2358</td>\n",
       "      <td>AR</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>esq. Blanco Encalada</td>\n",
       "      <td>1453</td>\n",
       "      <td>[O'Higgins 2358 (esq. Blanco Encalada), 1428 B...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5575901845117...</td>\n",
       "      <td>-34.557590</td>\n",
       "      <td>-58.455141</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1428</td>\n",
       "      <td>Buenos Aires C.F.</td>\n",
       "      <td>55e66874498ef95fcdeca8fb</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Los Arribeños</td>\n",
       "      <td>BBQ Joint</td>\n",
       "      <td>Arribeños 2707</td>\n",
       "      <td>AR</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>esq. Manuel Ugarte</td>\n",
       "      <td>929</td>\n",
       "      <td>[Arribeños 2707 (esq. Manuel Ugarte), C1428APM...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5525821214550...</td>\n",
       "      <td>-34.552582</td>\n",
       "      <td>-58.454771</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C1428APM</td>\n",
       "      <td>Buenos Aires C.F.</td>\n",
       "      <td>4b4d029cf964a520a2c726e3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>Checho</td>\n",
       "      <td>Steakhouse</td>\n",
       "      <td>Ramallo 1781</td>\n",
       "      <td>AR</td>\n",
       "      <td>Buenos Aires</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1643</td>\n",
       "      <td>[Ramallo 1781, 1429 Buenos Aires, Buenos Aires...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5398023101671...</td>\n",
       "      <td>-34.539802</td>\n",
       "      <td>-58.466433</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1429</td>\n",
       "      <td>Buenos Aires C.F.</td>\n",
       "      <td>4bdcc8353904a59343c24f9e</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>Carmín</td>\n",
       "      <td>Argentinian Restaurant</td>\n",
       "      <td>Juramento 1301</td>\n",
       "      <td>AR</td>\n",
       "      <td>Belgrano</td>\n",
       "      <td>Argentina</td>\n",
       "      <td>esquina Miñones</td>\n",
       "      <td>1188</td>\n",
       "      <td>[Juramento 1301 (esquina Miñones), C1428DMO Be...</td>\n",
       "      <td>[{'label': 'display', 'lat': -34.5554008034211...</td>\n",
       "      <td>-34.555401</td>\n",
       "      <td>-58.445590</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C1428DMO</td>\n",
       "      <td>Buenos Aires C.F.</td>\n",
       "      <td>4fb3df39e4b076d9e9d12f38</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                            name                                categories  \\\n",
       "0         Parrilla El Cocacolero                                Food Truck   \n",
       "1          La Esquina - Parrilla                                 BBQ Joint   \n",
       "2               Parrilla Besares                                 BBQ Joint   \n",
       "3           Parrilla Juan y Juan                                 BBQ Joint   \n",
       "4                 Parrilla Lumay                                      None   \n",
       "5           Gran Parrilla Crámer                                 BBQ Joint   \n",
       "6           Parrilla Villera Inn                                 BBQ Joint   \n",
       "7         Parrilla de la Barrera                                 BBQ Joint   \n",
       "8             Parrilla Al Carbon                    Argentinian Restaurant   \n",
       "9      Mi Pinche Pincha Parrilla  Residential Building (Apartment / Condo)   \n",
       "10              Parrilla al Paso                                      None   \n",
       "11               Parrilla Butler                                 BBQ Joint   \n",
       "12       Besares Parrilla Urbana                    Argentinian Restaurant   \n",
       "13               Parrilla Stoppy                    Argentinian Restaurant   \n",
       "14           Parrilla Un Clasico                                 BBQ Joint   \n",
       "15        Carmín Parrilla Urbana                                      None   \n",
       "16           La Parrilla De Tito                                 BBQ Joint   \n",
       "17  Placeres Criollos - Parrilla                                 BBQ Joint   \n",
       "18            Emperador parrilla                              Burger Joint   \n",
       "19       Besares Parrilla Urbana                                 BBQ Joint   \n",
       "20           La parrilla de Fede                                 BBQ Joint   \n",
       "21       El Paisano Kosher House                         Kosher Restaurant   \n",
       "22                 Los Arribeños                                 BBQ Joint   \n",
       "23                        Checho                                Steakhouse   \n",
       "24                        Carmín                    Argentinian Restaurant   \n",
       "\n",
       "                                    address  cc  \\\n",
       "0   Av. Costanera Norte Rafael Obligado s/n  AR   \n",
       "1       Mariscal Antonio José de Sucre 1299  AR   \n",
       "2                                       NaN  AR   \n",
       "3                            Arribenos 3600  AR   \n",
       "4                                    Grecia  AR   \n",
       "5               Av. Dr. Ricardo Balbín 2782  AR   \n",
       "6                             Ohiggins 2845  AR   \n",
       "7                            Arribeños 2108  AR   \n",
       "8                                       NaN  AR   \n",
       "9                                       NaN  AR   \n",
       "10                    Ciudad de la Paz 2009  AR   \n",
       "11                                      NaN  AR   \n",
       "12                    11 de Septiembre 3301  AR   \n",
       "13                              Moldes 2288  AR   \n",
       "14                         Roque Pérez 2801  AR   \n",
       "15                                      NaN  AR   \n",
       "16                                      NaN  AR   \n",
       "17                             Mendoza 2450  AR   \n",
       "18             Av Rafael Obligado Costanera  AR   \n",
       "19                    11 de septiembre 4098  AR   \n",
       "20                              Freire 2550  AR   \n",
       "21                           O'Higgins 2358  AR   \n",
       "22                           Arribeños 2707  AR   \n",
       "23                             Ramallo 1781  AR   \n",
       "24                           Juramento 1301  AR   \n",
       "\n",
       "                              city    country           crossStreet  distance  \\\n",
       "0                     Buenos Aires  Argentina                   NaN      1749   \n",
       "1                     Buenos Aires  Argentina          esq. Miñones      1443   \n",
       "2                              NaN  Argentina                   NaN       924   \n",
       "3                  Capital Federal  Argentina    Crisologo Larralde       977   \n",
       "4                     Buenos Aires  Argentina       Manuela Pedraza      1198   \n",
       "5                     Buenos Aires  Argentina    esq. Manuel Ugarte      2522   \n",
       "6                     Buenos Aires  Argentina           Av Congreso      1226   \n",
       "7                     Buenos Aires  Argentina        esq. Juramento      1408   \n",
       "8                              NaN  Argentina                   NaN      1475   \n",
       "9                              NaN  Argentina                   NaN       896   \n",
       "10                 Capital Federal  Argentina                   NaN      1843   \n",
       "11                             NaN  Argentina                   NaN      1915   \n",
       "12                    Buenos Aires  Argentina          esq. Besares       948   \n",
       "13  Ciudad Autónoma de Buenos Aire  Argentina              Olazabal      2112   \n",
       "14                    Buenos Aires  Argentina    esq. Miguel Ugarte      2833   \n",
       "15                    Buenos Aires  Argentina                   NaN      1560   \n",
       "16                             NaN  Argentina                   NaN      1472   \n",
       "17                 Capital Federal  Argentina                   NaN      1946   \n",
       "18                    Buenos Aires  Argentina                   NaN      1760   \n",
       "19                    Buenos Aires  Argentina          esq. Besares      1372   \n",
       "20                        Belgrano  Argentina                Monroe      2541   \n",
       "21                    Buenos Aires  Argentina  esq. Blanco Encalada      1453   \n",
       "22                    Buenos Aires  Argentina    esq. Manuel Ugarte       929   \n",
       "23                    Buenos Aires  Argentina                   NaN      1643   \n",
       "24                        Belgrano  Argentina       esquina Miñones      1188   \n",
       "\n",
       "                                     formattedAddress  \\\n",
       "0   [Av. Costanera Norte Rafael Obligado s/n, C142...   \n",
       "1   [Mariscal Antonio José de Sucre 1299 (esq. Miñ...   \n",
       "2                                         [Argentina]   \n",
       "3   [Arribenos 3600 (Crisologo Larralde), Capital ...   \n",
       "4   [Grecia (Manuela Pedraza), 1429 Buenos Aires, ...   \n",
       "5   [Av. Dr. Ricardo Balbín 2782 (esq. Manuel Ugar...   \n",
       "6   [Ohiggins 2845 (Av Congreso), Buenos Aires, Bu...   \n",
       "7   [Arribeños 2108 (esq. Juramento), C1428APB Bue...   \n",
       "8                                         [Argentina]   \n",
       "9                                         [Argentina]   \n",
       "10  [Ciudad de la Paz 2009, Capital Federal, Argen...   \n",
       "11                                        [Argentina]   \n",
       "12  [11 de Septiembre 3301 (esq. Besares), 1429 Bu...   \n",
       "13  [Moldes 2288 (Olazabal), Ciudad Autónoma de Bu...   \n",
       "14  [Roque Pérez 2801 (esq. Miguel Ugarte), C1430F...   \n",
       "15  [1428 Buenos Aires, Buenos Aires C.F., Argentina]   \n",
       "16                                        [Argentina]   \n",
       "17         [Mendoza 2450, Capital Federal, Argentina]   \n",
       "18  [Av Rafael Obligado Costanera, Buenos Aires, B...   \n",
       "19  [11 de septiembre 4098 (esq. Besares), C1429BI...   \n",
       "20  [Freire 2550 (Monroe), Belgrano, Buenos Aires ...   \n",
       "21  [O'Higgins 2358 (esq. Blanco Encalada), 1428 B...   \n",
       "22  [Arribeños 2707 (esq. Manuel Ugarte), C1428APM...   \n",
       "23  [Ramallo 1781, 1429 Buenos Aires, Buenos Aires...   \n",
       "24  [Juramento 1301 (esquina Miñones), C1428DMO Be...   \n",
       "\n",
       "                                       labeledLatLngs        lat        lng  \\\n",
       "0   [{'label': 'display', 'lat': -34.5469541248396... -34.546954 -58.430826   \n",
       "1   [{'label': 'display', 'lat': -34.5573286389577... -34.557329 -58.443922   \n",
       "2   [{'label': 'display', 'lat': -34.5526205031002... -34.552621 -58.454556   \n",
       "3   [{'label': 'display', 'lat': -34.5450293377858... -34.545029 -58.460460   \n",
       "4   [{'label': 'display', 'lat': -34.5464204, 'lng... -34.546420 -58.462799   \n",
       "5   [{'label': 'display', 'lat': -34.5607443356963... -34.560744 -58.469930   \n",
       "6   [{'label': 'display', 'lat': -34.5533057957818... -34.553306 -58.458983   \n",
       "7   [{'label': 'display', 'lat': -34.557947, 'lng'... -34.557947 -58.450354   \n",
       "8   [{'label': 'display', 'lat': -34.5585561468298... -34.558556 -58.449806   \n",
       "9   [{'label': 'display', 'lat': -34.5514259338378... -34.551426 -58.443451   \n",
       "10  [{'label': 'display', 'lat': -34.5607961465511... -34.560796 -58.456887   \n",
       "11  [{'label': 'display', 'lat': -34.5574035644531... -34.557404 -58.464657   \n",
       "12  [{'label': 'display', 'lat': -34.547819, 'lng'... -34.547819 -58.459678   \n",
       "13  [{'label': 'display', 'lat': -34.561928, 'lng'... -34.561928 -58.460904   \n",
       "14  [{'label': 'display', 'lat': -34.562032, 'lng'... -34.562032 -58.473095   \n",
       "15  [{'label': 'display', 'lat': -34.5590355433524... -34.559036 -58.453214   \n",
       "16  [{'label': 'display', 'lat': -34.5522514885047... -34.552251 -58.463465   \n",
       "17  [{'label': 'display', 'lat': -34.561395, 'lng'... -34.561395 -58.458107   \n",
       "18  [{'label': 'display', 'lat': -34.54719648, 'ln... -34.547196 -58.430737   \n",
       "19  [{'label': 'display', 'lat': -34.5417965226451... -34.541797 -58.464154   \n",
       "20  [{'label': 'display', 'lat': -34.5624144493328... -34.562414 -58.468154   \n",
       "21  [{'label': 'display', 'lat': -34.5575901845117... -34.557590 -58.455141   \n",
       "22  [{'label': 'display', 'lat': -34.5525821214550... -34.552582 -58.454771   \n",
       "23  [{'label': 'display', 'lat': -34.5398023101671... -34.539802 -58.466433   \n",
       "24  [{'label': 'display', 'lat': -34.5554008034211... -34.555401 -58.445590   \n",
       "\n",
       "                              neighborhood postalCode              state  \\\n",
       "0                                      NaN   C1428DYC  Buenos Aires C.F.   \n",
       "1                                      NaN   C1428DUM  Buenos Aires C.F.   \n",
       "2                                      NaN        NaN                NaN   \n",
       "3                                      NaN        NaN       Buenos Aires   \n",
       "4                                      NaN       1429          Cap. Fed.   \n",
       "5                                      NaN   C1428CVR  Buenos Aires C.F.   \n",
       "6                                      NaN        NaN  Buenos Aires C.F.   \n",
       "7                                      NaN   C1428APB  Buenos Aires C.F.   \n",
       "8                                      NaN        NaN                NaN   \n",
       "9                                      NaN        NaN                NaN   \n",
       "10                                     NaN        NaN                NaN   \n",
       "11                                     NaN        NaN                NaN   \n",
       "12  Núñez, Buenos Aires, Buenos Aires F.D.       1429  Buenos Aires C.F.   \n",
       "13                                     NaN        NaN                NaN   \n",
       "14                                     NaN   C1430FBG  Buenos Aires C.F.   \n",
       "15                                     NaN       1428  Buenos Aires C.F.   \n",
       "16                                     NaN        NaN                NaN   \n",
       "17                                     NaN        NaN                NaN   \n",
       "18                                     NaN        NaN  Buenos Aires C.F.   \n",
       "19  Núñez, Buenos Aires, Buenos Aires F.D.   C1429BIZ  Buenos Aires C.F.   \n",
       "20                                     NaN        NaN  Buenos Aires C.F.   \n",
       "21                                     NaN       1428  Buenos Aires C.F.   \n",
       "22                                     NaN   C1428APM  Buenos Aires C.F.   \n",
       "23                                     NaN       1429  Buenos Aires C.F.   \n",
       "24                                     NaN   C1428DMO  Buenos Aires C.F.   \n",
       "\n",
       "                          id  \n",
       "0   4dfabb87b61c6408772d39db  \n",
       "1   4c62e1147c9def3b2258d71c  \n",
       "2   4ed18b56722e01c583c85a5c  \n",
       "3   4c3a0a23dfb0e21e2772b1a8  \n",
       "4   4d61b0f5ef378cfa5c318ea6  \n",
       "5   4ba02227f964a520975c37e3  \n",
       "6   54a6a997498ec4ba52ab0160  \n",
       "7   5151c6afe4b06114b19467b4  \n",
       "8   4c464668f1b5c9b62a1d79ef  \n",
       "9   539c720b498e06f4cc766a06  \n",
       "10  4da657be0cb6ba7974d50a59  \n",
       "11  51db5eba498ed64a0f793e38  \n",
       "12  4d3785966eef5481148e3848  \n",
       "13  4c43990f36d6a593666769a8  \n",
       "14  5e362a7104e00e000849a180  \n",
       "15  529ae25711d299f45d8471b7  \n",
       "16  4fc27a5fe4b0c9a9f1c15df3  \n",
       "17  4ff4714be4b01a84ec7ddfdc  \n",
       "18  4dcff255d164679b8d246e21  \n",
       "19  53361af1498ebdf6b1fddfb9  \n",
       "20  4cd4c6c32944b1f7e55359ec  \n",
       "21  55e66874498ef95fcdeca8fb  \n",
       "22  4b4d029cf964a520a2c726e3  \n",
       "23  4bdcc8353904a59343c24f9e  \n",
       "24  4fb3df39e4b076d9e9d12f38  "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# keep only columns that include venue name, and anything that is associated with location\n",
    "filtered_columns = ['name', 'categories'] + [col for col in dataframe.columns if col.startswith('location.')] + ['id']\n",
    "dataframe_filtered = dataframe.loc[:, filtered_columns]\n",
    "\n",
    "# function that extracts the category of the venue\n",
    "def get_category_type(row):\n",
    "    try:\n",
    "        categories_list = row['categories']\n",
    "    except:\n",
    "        categories_list = row['venue.categories']\n",
    "        \n",
    "    if len(categories_list) == 0:\n",
    "        return None\n",
    "    else:\n",
    "        return categories_list[0]['name']\n",
    "\n",
    "# filter the category for each row\n",
    "dataframe_filtered['categories'] = dataframe_filtered.apply(get_category_type, axis=1)\n",
    "\n",
    "# clean column names by keeping only last term\n",
    "dataframe_filtered.columns = [column.split('.')[-1] for column in dataframe_filtered.columns]\n",
    "\n",
    "dataframe_filtered"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0           Parrilla El Cocacolero\n",
       "1            La Esquina - Parrilla\n",
       "2                 Parrilla Besares\n",
       "3             Parrilla Juan y Juan\n",
       "4                   Parrilla Lumay\n",
       "5             Gran Parrilla Crámer\n",
       "6             Parrilla Villera Inn\n",
       "7           Parrilla de la Barrera\n",
       "8               Parrilla Al Carbon\n",
       "9        Mi Pinche Pincha Parrilla\n",
       "10                Parrilla al Paso\n",
       "11                 Parrilla Butler\n",
       "12         Besares Parrilla Urbana\n",
       "13                 Parrilla Stoppy\n",
       "14             Parrilla Un Clasico\n",
       "15          Carmín Parrilla Urbana\n",
       "16             La Parrilla De Tito\n",
       "17    Placeres Criollos - Parrilla\n",
       "18              Emperador parrilla\n",
       "19         Besares Parrilla Urbana\n",
       "20             La parrilla de Fede\n",
       "21         El Paisano Kosher House\n",
       "22                   Los Arribeños\n",
       "23                          Checho\n",
       "24                          Carmín\n",
       "Name: name, dtype: object"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dataframe_filtered.name"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### Visualize in map"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div style=\"width:100%;\"><div style=\"position:relative;width:100%;height:0;padding-bottom:60%;\"><iframe src=\"about:blank\" style=\"position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;\" data-html=PCFET0NUWVBFIGh0bWw+CjxoZWFkPiAgICAKICAgIDxtZXRhIGh0dHAtZXF1aXY9ImNvbnRlbnQtdHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PVVURi04IiAvPgogICAgPHNjcmlwdD5MX1BSRUZFUl9DQU5WQVMgPSBmYWxzZTsgTF9OT19UT1VDSCA9IGZhbHNlOyBMX0RJU0FCTEVfM0QgPSBmYWxzZTs8L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2xlYWZsZXRAMS4yLjAvZGlzdC9sZWFmbGV0LmpzIj48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2FqYXguZ29vZ2xlYXBpcy5jb20vYWpheC9saWJzL2pxdWVyeS8xLjExLjEvanF1ZXJ5Lm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvanMvYm9vdHN0cmFwLm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvTGVhZmxldC5hd2Vzb21lLW1hcmtlcnMvMi4wLjIvbGVhZmxldC5hd2Vzb21lLW1hcmtlcnMuanMiPjwvc2NyaXB0PgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2xlYWZsZXRAMS4yLjAvZGlzdC9sZWFmbGV0LmNzcyIvPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9jc3MvYm9vdHN0cmFwLm1pbi5jc3MiLz4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvY3NzL2Jvb3RzdHJhcC10aGVtZS5taW4uY3NzIi8+CiAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vZm9udC1hd2Vzb21lLzQuNi4zL2Nzcy9mb250LWF3ZXNvbWUubWluLmNzcyIvPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9MZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy8yLjAuMi9sZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy5jc3MiLz4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9yYXdnaXQuY29tL3B5dGhvbi12aXN1YWxpemF0aW9uL2ZvbGl1bS9tYXN0ZXIvZm9saXVtL3RlbXBsYXRlcy9sZWFmbGV0LmF3ZXNvbWUucm90YXRlLmNzcyIvPgogICAgPHN0eWxlPmh0bWwsIGJvZHkge3dpZHRoOiAxMDAlO2hlaWdodDogMTAwJTttYXJnaW46IDA7cGFkZGluZzogMDt9PC9zdHlsZT4KICAgIDxzdHlsZT4jbWFwIHtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtib3R0b206MDtyaWdodDowO2xlZnQ6MDt9PC9zdHlsZT4KICAgIAogICAgICAgICAgICA8c3R5bGU+ICNtYXBfMGFlODI2YzBkYmMwNGMzYmFmOWVhNGYzNTg5ZWExOTggewogICAgICAgICAgICAgICAgcG9zaXRpb24gOiByZWxhdGl2ZTsKICAgICAgICAgICAgICAgIHdpZHRoIDogMTAwLjAlOwogICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAuMCU7CiAgICAgICAgICAgICAgICBsZWZ0OiAwLjAlOwogICAgICAgICAgICAgICAgdG9wOiAwLjAlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICA8L3N0eWxlPgogICAgICAgIAo8L2hlYWQ+Cjxib2R5PiAgICAKICAgIAogICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb2xpdW0tbWFwIiBpZD0ibWFwXzBhZTgyNmMwZGJjMDRjM2JhZjllYTRmMzU4OWVhMTk4IiA+PC9kaXY+CiAgICAgICAgCjwvYm9keT4KPHNjcmlwdD4gICAgCiAgICAKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGJvdW5kcyA9IG51bGw7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcF8wYWU4MjZjMGRiYzA0YzNiYWY5ZWE0ZjM1ODllYTE5OCA9IEwubWFwKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21hcF8wYWU4MjZjMGRiYzA0YzNiYWY5ZWE0ZjM1ODllYTE5OCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y2VudGVyOiBbLTM0LjU0NTMsLTU4LjQ0OThdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgem9vbTogMTUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhCb3VuZHM6IGJvdW5kcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyczogW10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JsZENvcHlKdW1wOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyczogTC5DUlMuRVBTRzM4NTcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciB0aWxlX2xheWVyXzZhMGE5ZDAxYTgyMDQ3MTc5ZDZkNTgzZWE0Mzc5MWVhID0gTC50aWxlTGF5ZXIoCiAgICAgICAgICAgICAgICAnaHR0cHM6Ly97c30udGlsZS5vcGVuc3RyZWV0bWFwLm9yZy97en0ve3h9L3t5fS5wbmcnLAogICAgICAgICAgICAgICAgewogICJhdHRyaWJ1dGlvbiI6IG51bGwsCiAgImRldGVjdFJldGluYSI6IGZhbHNlLAogICJtYXhab29tIjogMTgsCiAgIm1pblpvb20iOiAxLAogICJub1dyYXAiOiBmYWxzZSwKICAic3ViZG9tYWlucyI6ICJhYmMiCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzBhZTgyNmMwZGJjMDRjM2JhZjllYTRmMzU4OWVhMTk4KTsKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl8zNzlmYjdmNzBmMTY0MmM3ODUxZTMxZjQ3YjczNmMzNCA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWy0zNC41NDUzLC01OC40NDk4XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogInJlZCIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogInJlZCIsCiAgImZpbGxPcGFjaXR5IjogMC42LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogMjAsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGFlODI2YzBkYmMwNGMzYmFmOWVhNGYzNTg5ZWExOTgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfYTc3ZDZhNjA0ZDZkNDc0NGJlMWNhMmU5YmFlZGVmM2MgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfM2UzNDQ1NmJjOTkzNDQwNjliM2EyNGQwNmY5NTc3ZTcgPSAkKCc8ZGl2IGlkPSJodG1sXzNlMzQ0NTZiYzk5MzQ0MDY5YjNhMjRkMDZmOTU3N2U3IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5Db25yYWQgSG90ZWw8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2E3N2Q2YTYwNGQ2ZDQ3NDRiZTFjYTJlOWJhZWRlZjNjLnNldENvbnRlbnQoaHRtbF8zZTM0NDU2YmM5OTM0NDA2OWIzYTI0ZDA2Zjk1NzdlNyk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl8zNzlmYjdmNzBmMTY0MmM3ODUxZTMxZjQ3YjczNmMzNC5iaW5kUG9wdXAocG9wdXBfYTc3ZDZhNjA0ZDZkNDc0NGJlMWNhMmU5YmFlZGVmM2MpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfY2Y2YmQzOWVhMzc2NGY1ZmE2N2FmZGY1Yzc2MDdkYzQgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFstMzQuNTQ2OTU0MTI0ODM5NjgsLTU4LjQzMDgyNjI0Njc4NjU2Nl0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiYmx1ZSIsCiAgImZpbGxPcGFjaXR5IjogMC42LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogMTAsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGFlODI2YzBkYmMwNGMzYmFmOWVhNGYzNTg5ZWExOTgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZjI4Y2JmNTU0Y2U0NDY1NGFkOWY4MjdlMTY3MWQ2MDYgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfYTRjNjdhZjE4M2Q4NDdmOTgwYjQ1ZGQzNjQyZTE5ZmYgPSAkKCc8ZGl2IGlkPSJodG1sX2E0YzY3YWYxODNkODQ3Zjk4MGI0NWRkMzY0MmUxOWZmIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5Gb29kIFRydWNrPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9mMjhjYmY1NTRjZTQ0NjU0YWQ5ZjgyN2UxNjcxZDYwNi5zZXRDb250ZW50KGh0bWxfYTRjNjdhZjE4M2Q4NDdmOTgwYjQ1ZGQzNjQyZTE5ZmYpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfY2Y2YmQzOWVhMzc2NGY1ZmE2N2FmZGY1Yzc2MDdkYzQuYmluZFBvcHVwKHBvcHVwX2YyOGNiZjU1NGNlNDQ2NTRhZDlmODI3ZTE2NzFkNjA2KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzE5MWI3NDk0MTYyMDRhYWY5M2NjMWZlYzQ5MWMyOGZlID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbLTM0LjU1NzMyODYzODk1NzcxLC01OC40NDM5MjE5MDk3Njk3Nl0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiYmx1ZSIsCiAgImZpbGxPcGFjaXR5IjogMC42LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogMTAsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGFlODI2YzBkYmMwNGMzYmFmOWVhNGYzNTg5ZWExOTgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfNWU2YTUzYzI3YTFlNDNkYzg1ZTQ3NTFhYmNmMTA1M2UgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfMThkZDViYTEzN2FjNGQzNzhlYzVlMDAwODIyNjY5ZTAgPSAkKCc8ZGl2IGlkPSJodG1sXzE4ZGQ1YmExMzdhYzRkMzc4ZWM1ZTAwMDgyMjY2OWUwIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5CQlEgSm9pbnQ8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzVlNmE1M2MyN2ExZTQzZGM4NWU0NzUxYWJjZjEwNTNlLnNldENvbnRlbnQoaHRtbF8xOGRkNWJhMTM3YWM0ZDM3OGVjNWUwMDA4MjI2NjllMCk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl8xOTFiNzQ5NDE2MjA0YWFmOTNjYzFmZWM0OTFjMjhmZS5iaW5kUG9wdXAocG9wdXBfNWU2YTUzYzI3YTFlNDNkYzg1ZTQ3NTFhYmNmMTA1M2UpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfNjg1NTRkNmY5NzVmNDQ4NzlkZDYxYTRkNjQ0ZGYxMGQgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFstMzQuNTUyNjIwNTAzMTAwMjg2LC01OC40NTQ1NTYxNzQxMjIwMjVdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiYmx1ZSIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDEwLAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzBhZTgyNmMwZGJjMDRjM2JhZjllYTRmMzU4OWVhMTk4KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzc2MTQzMDVkOTI3YzRkMDE4OTI4ZGRmMTRhNjRmMWM2ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzc4ZDFmZGQ2ZWJlMTQ5MTM4ZjQxNTc2ZGFmNTZjZTMyID0gJCgnPGRpdiBpZD0iaHRtbF83OGQxZmRkNmViZTE0OTEzOGY0MTU3NmRhZjU2Y2UzMiIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+QkJRIEpvaW50PC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF83NjE0MzA1ZDkyN2M0ZDAxODkyOGRkZjE0YTY0ZjFjNi5zZXRDb250ZW50KGh0bWxfNzhkMWZkZDZlYmUxNDkxMzhmNDE1NzZkYWY1NmNlMzIpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfNjg1NTRkNmY5NzVmNDQ4NzlkZDYxYTRkNjQ0ZGYxMGQuYmluZFBvcHVwKHBvcHVwXzc2MTQzMDVkOTI3YzRkMDE4OTI4ZGRmMTRhNjRmMWM2KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzJhNWU5N2I3ZGZhMzRjOTQ5NTdkOTIyMTc4OWY0ZTdjID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbLTM0LjU0NTAyOTMzNzc4NTgsLTU4LjQ2MDQ2MDE1NjA2MDk0XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogImJsdWUiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICJibHVlIiwKICAiZmlsbE9wYWNpdHkiOiAwLjYsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiAxMCwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF8wYWU4MjZjMGRiYzA0YzNiYWY5ZWE0ZjM1ODllYTE5OCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF8zMjU4YTg5MGNiMTM0ZGNiYTIwY2ZlMTEyNTRkNzVlNiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF85NmYyODI5NWVhMjc0Njc5OGQ0NmIwNThkMjUwN2NhNyA9ICQoJzxkaXYgaWQ9Imh0bWxfOTZmMjgyOTVlYTI3NDY3OThkNDZiMDU4ZDI1MDdjYTciIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkJCUSBKb2ludDwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfMzI1OGE4OTBjYjEzNGRjYmEyMGNmZTExMjU0ZDc1ZTYuc2V0Q29udGVudChodG1sXzk2ZjI4Mjk1ZWEyNzQ2Nzk4ZDQ2YjA1OGQyNTA3Y2E3KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzJhNWU5N2I3ZGZhMzRjOTQ5NTdkOTIyMTc4OWY0ZTdjLmJpbmRQb3B1cChwb3B1cF8zMjU4YTg5MGNiMTM0ZGNiYTIwY2ZlMTEyNTRkNzVlNik7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl80NWY2YTBjMmIwYTc0MTQ0YjkwNTZjNzA2MTVhNWUyNyA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWy0zNC41NDY0MjA0LC01OC40NjI3OTk0XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogImJsdWUiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICJibHVlIiwKICAiZmlsbE9wYWNpdHkiOiAwLjYsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiAxMCwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF8wYWU4MjZjMGRiYzA0YzNiYWY5ZWE0ZjM1ODllYTE5OCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzA5OGNkOTQ2M2M2OTRmMTNhYWFlOWViZGFiYTI1MzNjID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbLTM0LjU2MDc0NDMzNTY5NjMzLC01OC40Njk5Mjk5NDQ1NzE2XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogImJsdWUiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICJibHVlIiwKICAiZmlsbE9wYWNpdHkiOiAwLjYsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiAxMCwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF8wYWU4MjZjMGRiYzA0YzNiYWY5ZWE0ZjM1ODllYTE5OCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9kYTZjNjczYWE1MGM0YWE0OWUyNTM2MzZiZWM0MDI0OSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF83NTNlZjczM2M3NWQ0ZTg0YmI1ZDU3NTg5ODMxYWNiMyA9ICQoJzxkaXYgaWQ9Imh0bWxfNzUzZWY3MzNjNzVkNGU4NGJiNWQ1NzU4OTgzMWFjYjMiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkJCUSBKb2ludDwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfZGE2YzY3M2FhNTBjNGFhNDllMjUzNjM2YmVjNDAyNDkuc2V0Q29udGVudChodG1sXzc1M2VmNzMzYzc1ZDRlODRiYjVkNTc1ODk4MzFhY2IzKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzA5OGNkOTQ2M2M2OTRmMTNhYWFlOWViZGFiYTI1MzNjLmJpbmRQb3B1cChwb3B1cF9kYTZjNjczYWE1MGM0YWE0OWUyNTM2MzZiZWM0MDI0OSk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl9iMDE4NTUzYzk5Yjk0ZTNjYTk1YmMyMDE0M2IzZTc3ZSA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWy0zNC41NTMzMDU3OTU3ODE4NywtNTguNDU4OTgyNzM4MjMwMzZdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiYmx1ZSIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDEwLAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzBhZTgyNmMwZGJjMDRjM2JhZjllYTRmMzU4OWVhMTk4KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzQ0MGEyMjk0M2EwMTRjMDZhNzU4NDA0ZmZmYzU1MmE1ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzU3ZDdkYjFmMTdkZTQxYjdhYTg2NzNjNjAxYmYwZThhID0gJCgnPGRpdiBpZD0iaHRtbF81N2Q3ZGIxZjE3ZGU0MWI3YWE4NjczYzYwMWJmMGU4YSIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+QkJRIEpvaW50PC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF80NDBhMjI5NDNhMDE0YzA2YTc1ODQwNGZmZmM1NTJhNS5zZXRDb250ZW50KGh0bWxfNTdkN2RiMWYxN2RlNDFiN2FhODY3M2M2MDFiZjBlOGEpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfYjAxODU1M2M5OWI5NGUzY2E5NWJjMjAxNDNiM2U3N2UuYmluZFBvcHVwKHBvcHVwXzQ0MGEyMjk0M2EwMTRjMDZhNzU4NDA0ZmZmYzU1MmE1KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzFjMDliNWY1ZjFhMzRlZGZhMDU0MGU3ZjQwY2NiODkzID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbLTM0LjU1Nzk0NywtNTguNDUwMzU0XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogImJsdWUiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICJibHVlIiwKICAiZmlsbE9wYWNpdHkiOiAwLjYsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiAxMCwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF8wYWU4MjZjMGRiYzA0YzNiYWY5ZWE0ZjM1ODllYTE5OCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9kMWZmZjA5OGFiYTY0NWQ2YmJhZjlkZTZhODhjZGVjNCA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF83N2UzOGFlNjAxYzI0Y2M4OTQ1MjBhMTJmOGFlNzQwZSA9ICQoJzxkaXYgaWQ9Imh0bWxfNzdlMzhhZTYwMWMyNGNjODk0NTIwYTEyZjhhZTc0MGUiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkJCUSBKb2ludDwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfZDFmZmYwOThhYmE2NDVkNmJiYWY5ZGU2YTg4Y2RlYzQuc2V0Q29udGVudChodG1sXzc3ZTM4YWU2MDFjMjRjYzg5NDUyMGExMmY4YWU3NDBlKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzFjMDliNWY1ZjFhMzRlZGZhMDU0MGU3ZjQwY2NiODkzLmJpbmRQb3B1cChwb3B1cF9kMWZmZjA5OGFiYTY0NWQ2YmJhZjlkZTZhODhjZGVjNCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl8xZGU1ZWEwZGViMWY0YmZhOTk5MTkwMzgyYmNkNDVlYiA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWy0zNC41NTg1NTYxNDY4Mjk4ODYsLTU4LjQ0OTgwNjQ0OTU0M10sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiYmx1ZSIsCiAgImZpbGxPcGFjaXR5IjogMC42LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogMTAsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGFlODI2YzBkYmMwNGMzYmFmOWVhNGYzNTg5ZWExOTgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZDQxNzQ5YTI2YTU4NDcwM2IyM2MwNmQ1OTk5NjgzN2UgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfY2MxMTAwZTU4M2MxNGYyMDljYWNhZjdlNjc4MGM3ZDkgPSAkKCc8ZGl2IGlkPSJodG1sX2NjMTEwMGU1ODNjMTRmMjA5Y2FjYWY3ZTY3ODBjN2Q5IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5BcmdlbnRpbmlhbiBSZXN0YXVyYW50PC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9kNDE3NDlhMjZhNTg0NzAzYjIzYzA2ZDU5OTk2ODM3ZS5zZXRDb250ZW50KGh0bWxfY2MxMTAwZTU4M2MxNGYyMDljYWNhZjdlNjc4MGM3ZDkpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfMWRlNWVhMGRlYjFmNGJmYTk5OTE5MDM4MmJjZDQ1ZWIuYmluZFBvcHVwKHBvcHVwX2Q0MTc0OWEyNmE1ODQ3MDNiMjNjMDZkNTk5OTY4MzdlKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2JjNzZjMmU4OWQxMDQ3ODRhY2MxMzE2NWE2MmVmMGQzID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbLTM0LjU1MTQyNTkzMzgzNzg5LC01OC40NDM0NTA5Mjc3MzQzNzVdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiYmx1ZSIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDEwLAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzBhZTgyNmMwZGJjMDRjM2JhZjllYTRmMzU4OWVhMTk4KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzcwNDk2YmYzZGE4MTRiZDBiNGQwMjViYzg1Y2Q2ODcxID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzUwYmFlYzFhOTlmODQ4MDhiMWM4Y2ZkZWI1ZTdjOWY3ID0gJCgnPGRpdiBpZD0iaHRtbF81MGJhZWMxYTk5Zjg0ODA4YjFjOGNmZGViNWU3YzlmNyIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+UmVzaWRlbnRpYWwgQnVpbGRpbmcgKEFwYXJ0bWVudCAvIENvbmRvKTwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfNzA0OTZiZjNkYTgxNGJkMGI0ZDAyNWJjODVjZDY4NzEuc2V0Q29udGVudChodG1sXzUwYmFlYzFhOTlmODQ4MDhiMWM4Y2ZkZWI1ZTdjOWY3KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyX2JjNzZjMmU4OWQxMDQ3ODRhY2MxMzE2NWE2MmVmMGQzLmJpbmRQb3B1cChwb3B1cF83MDQ5NmJmM2RhODE0YmQwYjRkMDI1YmM4NWNkNjg3MSk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl9kMjVjZmE1YmI0ZTI0MWY1YTc0ZjgzNGE0NzkzYzFkMCA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWy0zNC41NjA3OTYxNDY1NTExMSwtNTguNDU2ODg2NTEwMTk3MjddLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiYmx1ZSIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDEwLAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzBhZTgyNmMwZGJjMDRjM2JhZjllYTRmMzU4OWVhMTk4KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfNTdjOTNlNGMzNmE2NDJjMGJkNzMwNzQ0MzI1NGZhYmUgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFstMzQuNTU3NDAzNTY0NDUzMTI1LC01OC40NjQ2NTY4Mjk4MzM5ODRdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiYmx1ZSIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDEwLAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzBhZTgyNmMwZGJjMDRjM2JhZjllYTRmMzU4OWVhMTk4KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzJlYWI0NDVhZTJlMTRhYTBhNDM5M2ZkMTU4M2Y0NmE3ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzQ0N2M4ZGQyNjM3NTQyNWI5MzEzZTE3MjAzMGI5ZGUyID0gJCgnPGRpdiBpZD0iaHRtbF80NDdjOGRkMjYzNzU0MjViOTMxM2UxNzIwMzBiOWRlMiIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+QkJRIEpvaW50PC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF8yZWFiNDQ1YWUyZTE0YWEwYTQzOTNmZDE1ODNmNDZhNy5zZXRDb250ZW50KGh0bWxfNDQ3YzhkZDI2Mzc1NDI1YjkzMTNlMTcyMDMwYjlkZTIpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfNTdjOTNlNGMzNmE2NDJjMGJkNzMwNzQ0MzI1NGZhYmUuYmluZFBvcHVwKHBvcHVwXzJlYWI0NDVhZTJlMTRhYTBhNDM5M2ZkMTU4M2Y0NmE3KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2NiYTNiOGFiNzVjODRlMThhZWI3ZjY1NTgyY2M1MzIyID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbLTM0LjU0NzgxOSwtNTguNDU5Njc4XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogImJsdWUiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICJibHVlIiwKICAiZmlsbE9wYWNpdHkiOiAwLjYsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiAxMCwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF8wYWU4MjZjMGRiYzA0YzNiYWY5ZWE0ZjM1ODllYTE5OCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9kYzMxMzgyOWUzNTE0ZjZkOWQ5MzZjNmNjZGQ5NmFjNyA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF81NzgxN2UxNTQ3Mjc0ZjZmYTQzODM4MWIyNDMyN2IzMSA9ICQoJzxkaXYgaWQ9Imh0bWxfNTc4MTdlMTU0NzI3NGY2ZmE0MzgzODFiMjQzMjdiMzEiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkFyZ2VudGluaWFuIFJlc3RhdXJhbnQ8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2RjMzEzODI5ZTM1MTRmNmQ5ZDkzNmM2Y2NkZDk2YWM3LnNldENvbnRlbnQoaHRtbF81NzgxN2UxNTQ3Mjc0ZjZmYTQzODM4MWIyNDMyN2IzMSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9jYmEzYjhhYjc1Yzg0ZTE4YWViN2Y2NTU4MmNjNTMyMi5iaW5kUG9wdXAocG9wdXBfZGMzMTM4MjllMzUxNGY2ZDlkOTM2YzZjY2RkOTZhYzcpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfNjVkNDU3NDI1NzkwNGEwN2FmN2MxMGQyMmM0Y2Y3OTYgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFstMzQuNTYxOTI4LC01OC40NjA5MDRdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiYmx1ZSIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDEwLAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzBhZTgyNmMwZGJjMDRjM2JhZjllYTRmMzU4OWVhMTk4KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2ZiMzM1NDgyZjdiZTRmOTY5NTI0YjRkMmJhOTVhNzZlID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzA3N2RiNDNmZTYwMDQ1ODA5MzhjNDEyNmU3OTA0NmVmID0gJCgnPGRpdiBpZD0iaHRtbF8wNzdkYjQzZmU2MDA0NTgwOTM4YzQxMjZlNzkwNDZlZiIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+QXJnZW50aW5pYW4gUmVzdGF1cmFudDwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfZmIzMzU0ODJmN2JlNGY5Njk1MjRiNGQyYmE5NWE3NmUuc2V0Q29udGVudChodG1sXzA3N2RiNDNmZTYwMDQ1ODA5MzhjNDEyNmU3OTA0NmVmKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzY1ZDQ1NzQyNTc5MDRhMDdhZjdjMTBkMjJjNGNmNzk2LmJpbmRQb3B1cChwb3B1cF9mYjMzNTQ4MmY3YmU0Zjk2OTUyNGI0ZDJiYTk1YTc2ZSk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl8xNGIyOWEzNTU0MGQ0YjQwOWUyZDg0NjRjM2VlNTZhNSA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWy0zNC41NjIwMzIsLTU4LjQ3MzA5NV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiYmx1ZSIsCiAgImZpbGxPcGFjaXR5IjogMC42LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogMTAsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGFlODI2YzBkYmMwNGMzYmFmOWVhNGYzNTg5ZWExOTgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfMTdiNzY5NWZjZGI2NDNkMThkYzI4MmY4M2MxNDVkNWIgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfNmYyYjZhMzViZTI3NGRhNDg1ZGZiOWE1MjNjNGYyYmMgPSAkKCc8ZGl2IGlkPSJodG1sXzZmMmI2YTM1YmUyNzRkYTQ4NWRmYjlhNTIzYzRmMmJjIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5CQlEgSm9pbnQ8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzE3Yjc2OTVmY2RiNjQzZDE4ZGMyODJmODNjMTQ1ZDViLnNldENvbnRlbnQoaHRtbF82ZjJiNmEzNWJlMjc0ZGE0ODVkZmI5YTUyM2M0ZjJiYyk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl8xNGIyOWEzNTU0MGQ0YjQwOWUyZDg0NjRjM2VlNTZhNS5iaW5kUG9wdXAocG9wdXBfMTdiNzY5NWZjZGI2NDNkMThkYzI4MmY4M2MxNDVkNWIpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfN2IzNjI3ZDE2ZTIzNGU4NDhjOWU2MTc3ZmI4YzdhZjggPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFstMzQuNTU5MDM1NTQzMzUyNCwtNTguNDUzMjE0MDEwMjIzN10sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiYmx1ZSIsCiAgImZpbGxPcGFjaXR5IjogMC42LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogMTAsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGFlODI2YzBkYmMwNGMzYmFmOWVhNGYzNTg5ZWExOTgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl9iNjUxZTMwNjcxYmM0Y2FlYmE5MGE4NzlhZmM1MTcxMiA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWy0zNC41NTIyNTE0ODg1MDQ3NSwtNTguNDYzNDY1Mzc1MTY4NDVdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiYmx1ZSIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDEwLAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzBhZTgyNmMwZGJjMDRjM2JhZjllYTRmMzU4OWVhMTk4KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzFjOTg5NWY5MWE1NjQzNjk5ZWY0YzE1ODNhMTJlMTBiID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzk4YWVhNTRmOWRhMDRmNmI4NmQyODYyM2U0NDQ2YmJlID0gJCgnPGRpdiBpZD0iaHRtbF85OGFlYTU0ZjlkYTA0ZjZiODZkMjg2MjNlNDQ0NmJiZSIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+QkJRIEpvaW50PC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF8xYzk4OTVmOTFhNTY0MzY5OWVmNGMxNTgzYTEyZTEwYi5zZXRDb250ZW50KGh0bWxfOThhZWE1NGY5ZGEwNGY2Yjg2ZDI4NjIzZTQ0NDZiYmUpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfYjY1MWUzMDY3MWJjNGNhZWJhOTBhODc5YWZjNTE3MTIuYmluZFBvcHVwKHBvcHVwXzFjOTg5NWY5MWE1NjQzNjk5ZWY0YzE1ODNhMTJlMTBiKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2M0ZWJlMzZiMDRhMjQ2NTFhMTRiMmMwZjgwZDhlMWE3ID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbLTM0LjU2MTM5NSwtNTguNDU4MTA3XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogImJsdWUiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICJibHVlIiwKICAiZmlsbE9wYWNpdHkiOiAwLjYsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiAxMCwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF8wYWU4MjZjMGRiYzA0YzNiYWY5ZWE0ZjM1ODllYTE5OCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9jZTcxMjBhNmVlYmE0ZTdlYTg1NWNkODVlNzYyMWNjZiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF85ZGViN2NkNWY0MmU0Zjk5ODIyYzljMGQxZTEwMDkxZCA9ICQoJzxkaXYgaWQ9Imh0bWxfOWRlYjdjZDVmNDJlNGY5OTgyMmM5YzBkMWUxMDA5MWQiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkJCUSBKb2ludDwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfY2U3MTIwYTZlZWJhNGU3ZWE4NTVjZDg1ZTc2MjFjY2Yuc2V0Q29udGVudChodG1sXzlkZWI3Y2Q1ZjQyZTRmOTk4MjJjOWMwZDFlMTAwOTFkKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyX2M0ZWJlMzZiMDRhMjQ2NTFhMTRiMmMwZjgwZDhlMWE3LmJpbmRQb3B1cChwb3B1cF9jZTcxMjBhNmVlYmE0ZTdlYTg1NWNkODVlNzYyMWNjZik7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl8yOTY2NDAxYmIyZWE0NWUyYmYyZWE3NTZjMDE3NzAzZSA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWy0zNC41NDcxOTY0OCwtNTguNDMwNzM2NjVdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiYmx1ZSIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDEwLAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzBhZTgyNmMwZGJjMDRjM2JhZjllYTRmMzU4OWVhMTk4KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2EzNzcyOTZlYjY0ZTQyMTNhOGFkYmQ0YTdiZjNkMDA2ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2E4NWRlMTU2Njc5MDRlMTFhZmQyMDU1NzUwYmNiNjQyID0gJCgnPGRpdiBpZD0iaHRtbF9hODVkZTE1NjY3OTA0ZTExYWZkMjA1NTc1MGJjYjY0MiIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+QnVyZ2VyIEpvaW50PC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9hMzc3Mjk2ZWI2NGU0MjEzYThhZGJkNGE3YmYzZDAwNi5zZXRDb250ZW50KGh0bWxfYTg1ZGUxNTY2NzkwNGUxMWFmZDIwNTU3NTBiY2I2NDIpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfMjk2NjQwMWJiMmVhNDVlMmJmMmVhNzU2YzAxNzcwM2UuYmluZFBvcHVwKHBvcHVwX2EzNzcyOTZlYjY0ZTQyMTNhOGFkYmQ0YTdiZjNkMDA2KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2M2YWY0Y2M3NTQ2OTQ1NjJiNTc2NGQ3Y2YxMDNkZGM2ID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbLTM0LjU0MTc5NjUyMjY0NTE4LC01OC40NjQxNTM4ODU1MzI2Ml0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiYmx1ZSIsCiAgImZpbGxPcGFjaXR5IjogMC42LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogMTAsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGFlODI2YzBkYmMwNGMzYmFmOWVhNGYzNTg5ZWExOTgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZDYyMTgwNDA0OGIyNDQ2ZmI4ZjMzODBhODI5NjVjMDcgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfZTJkODU2ZDg0NWRhNDU1Mzg1ZWEwYTk5NDU2ZDFiMTggPSAkKCc8ZGl2IGlkPSJodG1sX2UyZDg1NmQ4NDVkYTQ1NTM4NWVhMGE5OTQ1NmQxYjE4IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5CQlEgSm9pbnQ8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2Q2MjE4MDQwNDhiMjQ0NmZiOGYzMzgwYTgyOTY1YzA3LnNldENvbnRlbnQoaHRtbF9lMmQ4NTZkODQ1ZGE0NTUzODVlYTBhOTk0NTZkMWIxOCk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9jNmFmNGNjNzU0Njk0NTYyYjU3NjRkN2NmMTAzZGRjNi5iaW5kUG9wdXAocG9wdXBfZDYyMTgwNDA0OGIyNDQ2ZmI4ZjMzODBhODI5NjVjMDcpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfNjFlNTY2Mzc5N2M2NDI5Nzg3NzhmYjM0NGRhOWQzYTcgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFstMzQuNTYyNDE0NDQ5MzMyODksLTU4LjQ2ODE1NDE4NzM1OTEyNl0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiYmx1ZSIsCiAgImZpbGxPcGFjaXR5IjogMC42LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogMTAsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGFlODI2YzBkYmMwNGMzYmFmOWVhNGYzNTg5ZWExOTgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfNTQxNDZkNDBjNzYzNGU5OWJmMmU4Y2Y2MWQxMzgxZGYgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfMjIzODEyYmVkYzIwNDZmOTg2MzA4YjQ4NDI5MmRmMzcgPSAkKCc8ZGl2IGlkPSJodG1sXzIyMzgxMmJlZGMyMDQ2Zjk4NjMwOGI0ODQyOTJkZjM3IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5CQlEgSm9pbnQ8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzU0MTQ2ZDQwYzc2MzRlOTliZjJlOGNmNjFkMTM4MWRmLnNldENvbnRlbnQoaHRtbF8yMjM4MTJiZWRjMjA0NmY5ODYzMDhiNDg0MjkyZGYzNyk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl82MWU1NjYzNzk3YzY0Mjk3ODc3OGZiMzQ0ZGE5ZDNhNy5iaW5kUG9wdXAocG9wdXBfNTQxNDZkNDBjNzYzNGU5OWJmMmU4Y2Y2MWQxMzgxZGYpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfODU1YWRiNGM4ZjliNGUxMjliNTEzZGYzYzVhYzAxZDkgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFstMzQuNTU3NTkwMTg0NTExNzUsLTU4LjQ1NTE0MDU5MDY2NzcyNV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiYmx1ZSIsCiAgImZpbGxPcGFjaXR5IjogMC42LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogMTAsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGFlODI2YzBkYmMwNGMzYmFmOWVhNGYzNTg5ZWExOTgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfNjBmY2VjODU2ZDBiNGY4OWEwMzUyNWI1YzFmZWYzNzcgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfODAyMWY0OWQ5MTUxNDBlNTk1ZjE0Y2NkNTA2ZGUxMzYgPSAkKCc8ZGl2IGlkPSJodG1sXzgwMjFmNDlkOTE1MTQwZTU5NWYxNGNjZDUwNmRlMTM2IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5Lb3NoZXIgUmVzdGF1cmFudDwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfNjBmY2VjODU2ZDBiNGY4OWEwMzUyNWI1YzFmZWYzNzcuc2V0Q29udGVudChodG1sXzgwMjFmNDlkOTE1MTQwZTU5NWYxNGNjZDUwNmRlMTM2KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzg1NWFkYjRjOGY5YjRlMTI5YjUxM2RmM2M1YWMwMWQ5LmJpbmRQb3B1cChwb3B1cF82MGZjZWM4NTZkMGI0Zjg5YTAzNTI1YjVjMWZlZjM3Nyk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl8zOTMwOTMwOGVkNjA0NjhkOGM5MmY2Mjg2NWI4ZDUyNiA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWy0zNC41NTI1ODIxMjE0NTUwMjUsLTU4LjQ1NDc3MTA0MTQwMjEyNV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiYmx1ZSIsCiAgImZpbGxPcGFjaXR5IjogMC42LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogMTAsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGFlODI2YzBkYmMwNGMzYmFmOWVhNGYzNTg5ZWExOTgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZjY5ZTE2MWRiMDdkNDE3Y2FmMzA2NzQ4NDVkMzY5ODYgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfZDY5OTRhZDc4OGY3NGFhM2E3MGY1MTYxMGM4M2QzZTkgPSAkKCc8ZGl2IGlkPSJodG1sX2Q2OTk0YWQ3ODhmNzRhYTNhNzBmNTE2MTBjODNkM2U5IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5CQlEgSm9pbnQ8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2Y2OWUxNjFkYjA3ZDQxN2NhZjMwNjc0ODQ1ZDM2OTg2LnNldENvbnRlbnQoaHRtbF9kNjk5NGFkNzg4Zjc0YWEzYTcwZjUxNjEwYzgzZDNlOSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl8zOTMwOTMwOGVkNjA0NjhkOGM5MmY2Mjg2NWI4ZDUyNi5iaW5kUG9wdXAocG9wdXBfZjY5ZTE2MWRiMDdkNDE3Y2FmMzA2NzQ4NDVkMzY5ODYpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfZTc4MWUxZThmZmY2NDkxM2ExZjUyMmQ0NGRmMjk0MGIgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFstMzQuNTM5ODAyMzEwMTY3MTMsLTU4LjQ2NjQzMzM5MjgzNTYwNF0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiYmx1ZSIsCiAgImZpbGxPcGFjaXR5IjogMC42LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogMTAsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGFlODI2YzBkYmMwNGMzYmFmOWVhNGYzNTg5ZWExOTgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfYmNlNjgyMzM4NjYyNGZiNWFmZmY0M2ZmMTZmMTA1YTkgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfYmRmMzc0OWM1Y2EyNDdiZTk0YzViMWYzODI5Mzg5YzIgPSAkKCc8ZGl2IGlkPSJodG1sX2JkZjM3NDljNWNhMjQ3YmU5NGM1YjFmMzgyOTM4OWMyIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5TdGVha2hvdXNlPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9iY2U2ODIzMzg2NjI0ZmI1YWZmZjQzZmYxNmYxMDVhOS5zZXRDb250ZW50KGh0bWxfYmRmMzc0OWM1Y2EyNDdiZTk0YzViMWYzODI5Mzg5YzIpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfZTc4MWUxZThmZmY2NDkxM2ExZjUyMmQ0NGRmMjk0MGIuYmluZFBvcHVwKHBvcHVwX2JjZTY4MjMzODY2MjRmYjVhZmZmNDNmZjE2ZjEwNWE5KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2E1YjQxOTU0MTU5YzRmZDc4NWI4ZWU3MjAzNGQ4MGEzID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbLTM0LjU1NTQwMDgwMzQyMTEsLTU4LjQ0NTU5MDEwMjYzNjE0XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogImJsdWUiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICJibHVlIiwKICAiZmlsbE9wYWNpdHkiOiAwLjYsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiAxMCwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF8wYWU4MjZjMGRiYzA0YzNiYWY5ZWE0ZjM1ODllYTE5OCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF80MzBjNzZmYjRhMTI0OGU0OWYwYzc4NTM1YTdmMWEyZCA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9kNTYwOThmYWM1M2I0ZjYxOGM2NGE4MWE1MzgxYzJhMCA9ICQoJzxkaXYgaWQ9Imh0bWxfZDU2MDk4ZmFjNTNiNGY2MThjNjRhODFhNTM4MWMyYTAiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkFyZ2VudGluaWFuIFJlc3RhdXJhbnQ8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzQzMGM3NmZiNGExMjQ4ZTQ5ZjBjNzg1MzVhN2YxYTJkLnNldENvbnRlbnQoaHRtbF9kNTYwOThmYWM1M2I0ZjYxOGM2NGE4MWE1MzgxYzJhMCk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9hNWI0MTk1NDE1OWM0ZmQ3ODViOGVlNzIwMzRkODBhMy5iaW5kUG9wdXAocG9wdXBfNDMwYzc2ZmI0YTEyNDhlNDlmMGM3ODUzNWE3ZjFhMmQpOwoKICAgICAgICAgICAgCiAgICAgICAgCjwvc2NyaXB0Pg== onload=\"this.contentDocument.open();this.contentDocument.write(atob(this.getAttribute('data-html')));this.contentDocument.close();\" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div>"
      ],
      "text/plain": [
       "<folium.folium.Map at 0x7f86cf033860>"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "venues_map = folium.Map(location=[latitude, longitude], zoom_start=15) # generate map centred around the Conrad Hotel\n",
    "\n",
    "# Add a red circle marker to represent the River Plate Stadium\n",
    "folium.features.CircleMarker(\n",
    "    [latitude, longitude],\n",
    "    radius=20,\n",
    "    color='red',\n",
    "    popup='Conrad Hotel',\n",
    "    fill = True,\n",
    "    fill_color = 'red',\n",
    "    fill_opacity = 0.6\n",
    ").add_to(venues_map)\n",
    "\n",
    "# add the Parrilla: Grills/BBQs restaurants as blue circle markers\n",
    "for lat, lng, label in zip(dataframe_filtered.lat, dataframe_filtered.lng, dataframe_filtered.categories):\n",
    "    folium.features.CircleMarker(\n",
    "        [lat, lng],\n",
    "        radius=10,\n",
    "        color='blue',\n",
    "        popup=label,\n",
    "        fill = True,\n",
    "        fill_color='blue',\n",
    "        fill_opacity=0.6\n",
    "    ).add_to(venues_map)\n",
    "\n",
    "# display map\n",
    "venues_map"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3.6",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
